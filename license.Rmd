# Licensing {#licensing}

```{r, include = FALSE}
source("common.R")
```

```{=html}
<!-- 
useful resources:
* https://thinkr-open.github.io/licensing-r/rlicense.html
* https://seankross.com/2016/08/02/How-R-Packages-are-Licensed.html
* https://github.com/ropensci/unconf17/issues/32
-->
```
**--- WORK IN PROGRESS ---**

The intent of this chapter is to give you a basic mental model of software license as it pertains to R packages.
This is a rich and complex field and I can only give you the barest glimpse.
But please bear in mind that we're R software developers and not lawyers, so while we've done our best to ensure this chapter is accurate, you should consult with a lawyer who specialises in open source code for high-stakes questions.

Open source licenses are "powered" by copyright law, i.e. if someone violates a license, the legal tool that allows them to be punished is copyright law.
This means any general exceptions to copyright law also apply to open source licenses (e.g. you may have additional rights granted by "fair use").
But most importantly this means that interpretation of licenses does vary from country to country.
The advice in this chapter is based on US copyright law; much of it is true in any country but important details may be different.
Again, if you are making important business decisions, you need to consult a local lawyer.

It's important to note that all open source licenses allow you to do whatever you like with the code locally.
It's only when you go to distribute your code to others outside of your organisation.
It's also important to note that copyright law doesn't say anything about output produced from copyrighted code, so you are free to license (or not) any R code that you produce.
Practically, this means that your *use* of R code is barely influenced by the licenses of the packages that you use.

A separate issue is that of attribution: making sure that all contributors are fairly acknowledged for their work.
This is generally (but not always) outside of the realm of open source licenses, but is something that is very important to do.

Code you write.
Code you take.
Code you receive.

What does distributing mean?

<https://stat.ethz.ch/pipermail/r-devel/2009-May/053248.html>

Challenges of licensing data.
Not copyrightable in the US, so open source licenses, which are enforced through copyright law, don't apply.

Biases:

## Code you write

We'll start by discussion the mechanics, because that's easiest.
Then we'll go on to talk about common license options for R packages, and why you might prefer one over the other.

### Mechanics

-   License field in DESCRIPTION.
    For some licenses this is all you need for CRAN.

-   `LICENSE` file --- this is required for some licenses.
    For example the MIT License requires year and name of copyright holders.

-   `LICENSE.md`, in `.Rbuildignore`, CRAN does not like you to include the text of existing licenses.
    But that is generally good practice so that when folks from outside the R community look at your package they know what the license is.
    So our compromise position is to include the full license as a `.md` file, but include it in `.Rbuildignore` so that it doesn't get shipped to CRAN.

-   `LICENSE.note` --- needed when parts of your package have different licenses.
    More on that below.

Easiest way to be in compliance is to use `use_mit_license()` etc which take care of the details for you.

### Popular licenses

<https://seankross.com/2016/08/02/How-R-Packages-are-Licensed.html>

```{r}
library(dplyr)
library(stringr)

packages <- as_tibble(available.packages())

parsed <- packages %>% 
  select(license = License) %>% 
  mutate(
    or_file = str_detect(license, fixed("| file LICENSE")),
    plus_file = str_detect(license, fixed("+ file LICENSE")),
    license = str_remove(license, " [+|] file LICENSE")
  ) 

parsed %>% count(str_detect(license, "GPL"))

# GPL variants
parsed %>% 
  filter(str_detect(license, "GPL")) %>% 
  count(license, sort = TRUE) %>% 
  head(10) %>% 
  knitr::kable()

# Everything else
parsed %>% 
  filter(!str_detect(license, "GPL")) %>% 
  count(license, sort = TRUE) %>% 
  head(10) %>% 
  knitr::kable()
```

#### GPL

GPL-2, GPL-3, LGPL, AGPL

GPL-2 and GPL-3 are not compatible, so if you want to use a GPL license and don't otherwise have strong opinions about v2 vs v3, we recommend GPL (\>= 2.0).
This also ensures that your compatible with any future GPL versions.
(But also implies that you trust the Free Software Foundation to continue to produce licenses in line with your values)

> If I only make copies of a GPL-covered program and run them, without distributing or conveying them to others, what does the license require of me?
> Nothing.
> The GPL does not place any conditions on this activity --- <https://www.gnu.org/licenses/gpl-faq.en.html#NoDistributionRequirements> (and use within an organisation isn't [distribution](https://www.gnu.org/licenses/gpl-faq.en.html#InternalDistribution))

#### MIT and BSD

<https://writing.kemitchell.com/2016/09/21/MIT-License-Line-by-Line.html>

Most popular license in over programming languages: <https://github.blog/2015-03-09-open-source-license-usage-on-github-com/> --- 45% of Github projects with licenses in 2015 used MIT.
13% used GPLv2, 9% used GPLv3.

#### CC0

Best used for data packages.
In the US, raw collections of facts is not copyrightable.
So this basically clearly expresses ...

#### Proprietary license

<https://unconj.ca/blog/copyright-in-closed-source-r-packages-the-right-way.html>

#### Other

### Work made for hire

Who owns the copyright?
If it's something you do as an employee, in the scope of your employment, your employer owns it.
If it's a contract, you own it, unless you've explicitly agree otherwise.

<http://worksmadeforhire.com>

### Relicensing

If you want to change the license of your package, you need to get agreement of all copyright holders.
Unless you've done something special (like a used CLA, more on that below), the copyright holders will be every non-trivial contributor to your package.

So to change the licence you need to:

-   Find all non-trivial contributor.
    You can get a list of all contributors from GitHub, and then you'll need to review them to see if they're "trivial".
    There's no precise definition of triviality but a typo fix is unlikely to constitute a copyright claim.
    But generally you should lean on the side of caution, and if you're not sure whether or not a contribution is trivial, you should ask.

-   You then need to confirm with every contribution that they're ok changing the license.
    If everyone is on github, the easiest way to do this is to create an issue where you list all contributors and ask them to confirm that they're ok with the change.

    -   <https://github.com/r-lib/generics/issues/49>
    -   <https://github.com/r-lib/covr/issues/256>

-   Once all copyright holders have confirmed, you can make the change.

## Code you borrow

Many package include code written by other people.

### License compatibility

First, need to make sure that your package license is compatible with the licenses of all included code.
What does that mean?
It means there must be a single named license that is as restrictive or more restrictive than all licensed software.

-   If you're lucky the code you want to include uses the same license as your package, and you're done with this step.

-   If it's not the same, it might be compatible.
    Of the licenses we discussed above, MIT is the easiest to work with as it's compatible with basically every thing else.
    GPL is more complex; GPLv2 and GPLv3 are not compatible: <https://www.gnu.org/licenses/gpl-faq.en.html#AllCompatibility>.
    [Various Licenses and Comments about Them](https://www.gnu.org/licenses/license-list.html) describes what licenses are compatible with the GPL license.

-   If it's not compatible, you can not include the code into your package.
    You'll need to keep the code separate so that it is not distributed together.

### Existing licenses

Important to preserve all existing license and copyright statements.
If you're including a fragment of another project, generally best to put in it's own file and ensure that file has copyright statements at the top.
If you're including multiple files, put in a directory, and put a LICENSE file in that directory.

### Metadata

You need to include the authors of any included code in your `Authors@R`:

-   `role = "cph"` --- declares that they're a copyright holder for part of your package

-   `comment = "Author of included â€¦"` --- makes it clear what they're responsible for.

Some examples: shiny, leaflet, diffviewer

`LICENSE.note` should include a text description reinforcing that the package as a whole is licensed under a single license, but individual components maybe available under more liberal licenses.
And where you can find them.

## Code you receive

By default, when someone contributes code to your repo, you can assume that they are happy with the license.
They are implicitly agreeing to it, but still retain copyright of their work.

<https://docs.github.com/en/github/site-policy/github-terms-of-service#6-contributions-under-repository-license>

Developer certificate of origin: <https://developercertificate.org>

### Contributor license agreement

A CLA forces them to be explicit (which may be required if you're in a legally conservative environment) or you may want them to also turn over their copyright to you.
The chief advantage of this is that it allows you to re-license the code.

For example, RStudio uses a CLA on the IDE to ensure that as well as providing an open-source version that's free to use by the public, we can also provide a commercially licensed version for companies who don't like the license it's under.

<https://cla-assistant.io>

### Recording contributors

When do you put in the DESCRIPTION.
In tidyverse packages, we tend only include major contributors; people who have contributed multiple PRs over multiple years.
