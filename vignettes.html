<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 16 Vignettes | R Packages</title>
<meta name="author" content="Hadley Wickham">
<meta name="author" content="Jennifer Bryan">
<meta name="description" content="::: {.rmdnote} You are reading the work-in-progress second edition of R Packages. This chapter is undergoing heavy restructuring and may be confusing or incomplete. ::: A vignette is a long-form...">
<meta name="generator" content="bookdown 0.27 with bs4_book()">
<meta property="og:title" content="Chapter 16 Vignettes | R Packages">
<meta property="og:type" content="book">
<meta property="og:url" content="https://r-pkgs.org/vignettes.html">
<meta property="og:image" content="https://r-pkgs.org/images/cover.png">
<meta property="og:description" content="::: {.rmdnote} You are reading the work-in-progress second edition of R Packages. This chapter is undergoing heavy restructuring and may be confusing or incomplete. ::: A vignette is a long-form...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 16 Vignettes | R Packages">
<meta name="twitter:site" content="@hadley">
<meta name="twitter:description" content="::: {.rmdnote} You are reading the work-in-progress second edition of R Packages. This chapter is undergoing heavy restructuring and may be confusing or incomplete. ::: A vignette is a long-form...">
<meta name="twitter:image" content="https://r-pkgs.org/images/cover.png">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.3.1/transition.js"></script><script src="libs/bs3compat-0.3.1/tabs.js"></script><script src="libs/bs3compat-0.3.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-141182576-1"></script><script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-141182576-1');
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<style type="text/css">
    /* Used with Pandoc 2.11+ new --citeproc when CSL is used */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
        }
    .hanging div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }
  </style>
<link rel="stylesheet" href="style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">R Packages</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Welcome!</a></li>
<li><a class="" href="preface.html">Preface</a></li>
<li class="book-part">Getting started</li>
<li><a class="" href="intro.html"><span class="header-section-number">1</span> Introduction</a></li>
<li><a class="" href="whole-game.html"><span class="header-section-number">2</span> The whole game</a></li>
<li><a class="" href="setup.html"><span class="header-section-number">3</span> System setup</a></li>
<li><a class="" href="package-structure-state.html"><span class="header-section-number">4</span> Package structure and state</a></li>
<li><a class="" href="workflows101.html"><span class="header-section-number">5</span> Fundamental development workflows</a></li>
<li><a class="" href="package-within.html"><span class="header-section-number">6</span> The package within</a></li>
<li class="book-part">Package components</li>
<li><a class="" href="r.html"><span class="header-section-number">7</span> R code</a></li>
<li><a class="" href="data.html"><span class="header-section-number">8</span> Data</a></li>
<li><a class="" href="misc.html"><span class="header-section-number">9</span> Other components</a></li>
<li class="book-part">Package metadata</li>
<li><a class="" href="description-and-namespace.html"><span class="header-section-number">10</span> DESCRIPTION and NAMESPACE</a></li>
<li><a class="" href="description-dependencies.html"><span class="header-section-number">11</span> Dependencies: What does your package need?</a></li>
<li><a class="" href="license.html"><span class="header-section-number">12</span> Licensing</a></li>
<li class="book-part">Testing</li>
<li><a class="" href="tests.html"><span class="header-section-number">13</span> Testing</a></li>
<li class="book-part">Documentation</li>
<li><a class="" href="doc-intro.html"><span class="header-section-number">14</span> Introduction</a></li>
<li><a class="" href="man.html"><span class="header-section-number">15</span> Function documentation</a></li>
<li><a class="active" href="vignettes.html"><span class="header-section-number">16</span> Vignettes</a></li>
<li><a class="" href="important-files.html"><span class="header-section-number">17</span> Other markdown files</a></li>
<li><a class="" href="website.html"><span class="header-section-number">18</span> Website</a></li>
<li class="book-part">Maintenance and distribution</li>
<li><a class="" href="r-cmd-check.html"><span class="header-section-number">19</span> R CMD check</a></li>
<li><a class="" href="continuous-integration.html"><span class="header-section-number">20</span> Continuous integration</a></li>
<li><a class="" href="release.html"><span class="header-section-number">21</span> Releasing to CRAN</a></li>
<li><a class="" href="lifecycle.html"><span class="header-section-number">22</span> Lifecycle</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/hadley/r-pkgs">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="vignettes" class="section level1" number="16">
<h1>
<span class="header-section-number">16</span> Vignettes<a class="anchor" aria-label="anchor" href="#vignettes"><i class="fas fa-link"></i></a>
</h1>
<!--
Notes re: revision

Maybe can be combined with object documentation? Unifying theme: "Built-in docs". In contrast to "web docs", e.g. pkgdown.
-->
<p>::: {.rmdnote}
You are reading the work-in-progress second edition of R Packages. This chapter is undergoing heavy restructuring and may be confusing or incomplete. :::</p>
<p>A vignette is a long-form guide to your package.
Function documentation is great if you know the name of the function you need, but it’s useless otherwise.
A vignette is like a book chapter or an academic paper: it can describe the problem that your package is designed to solve, and then show the reader how to solve it.</p>
<p>Many existing packages have vignettes.
You can see all the installed vignettes with <code><a href="https://rdrr.io/r/utils/browseVignettes.html">browseVignettes()</a></code>.
To see the vignette for a specific package, use the argument, <code>browseVignettes("packagename")</code>.
Each vignette provides three things: the original source file, a readable HTML page or PDF, and a file of R code.
You can read a specific vignette with <code>vignette(x)</code>, and see its code with <code>edit(vignette(x))</code>.
To see vignettes for a package you haven’t installed, look at its CRAN page, e.g., <a href="https://cran.r-project.org/web/packages/dplyr" class="uri">https://cran.r-project.org/web/packages/dplyr</a>.</p>
<p>In this chapter, we’re going to use RMarkdown to write our vignettes.
If you’re not already familiar with RMarkdown you’ll need to learn the basics elsewhere; at good place to start is <a href="https://rmarkdown.rstudio.com/" class="uri">https://rmarkdown.rstudio.com/</a>.</p>
<p>Older packages can include vignettes written with Sweave, a precursor to RMarkdown.
If this describes, your package, I highly recommend switching to RMarkdown.</p>
<div id="vignette-workflow" class="section level2" number="16.1">
<h2>
<span class="header-section-number">16.1</span> Vignette workflow<a class="anchor" aria-label="anchor" href="#vignette-workflow"><i class="fas fa-link"></i></a>
</h2>
<p>To create your first vignette, run:</p>
<div class="sourceCode" id="cb248"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">usethis</span><span class="fu">::</span><span class="fu"><a href="https://usethis.r-lib.org/reference/use_vignette.html">use_vignette</a></span><span class="op">(</span><span class="st">"my-vignette"</span><span class="op">)</span></span></code></pre></div>
<p>This will:</p>
<ol style="list-style-type: decimal">
<li><p>Create a <code>vignettes/</code> directory.</p></li>
<li><p>Add the necessary dependencies to <code>DESCRIPTION</code> (i.e. it adds knitr to the <code>Suggests</code> and <code>VignetteBuilder</code> fields).</p></li>
<li><p>Draft a vignette, <code>vignettes/my-vignette.Rmd</code>.</p></li>
</ol>
<p>The draft vignette has been designed to remind you of the important parts of an R Markdown file.
It serves as a useful reference when you’re creating a new vignette.
Once you have this file, the workflow is straightforward:</p>
<ol style="list-style-type: decimal">
<li><p>Modify the vignette.</p></li>
<li><div class="inline-figure">Press Ctrl/Cmd + Shift + K (or click <img src="images/knit.png"><!-- -->) to knit the vignette and preview the output.</div></li>
<li><p>This builds with the installed package — but you probably want the dev package.
Use <code><a href="https://devtools.r-lib.org/reference/build_rmd.html">devtools::build_rmd()</a></code>.</p></li>
</ol>
<p>The check workflow, <code>Cmd + Shift + E</code>, will run the code in all vignettes.
This is a good way to verify that you’ve captured all the needed dependencies.</p>
</div>
<div id="vignette-metadata" class="section level2" number="16.2">
<h2>
<span class="header-section-number">16.2</span> Metadata<a class="anchor" aria-label="anchor" href="#vignette-metadata"><i class="fas fa-link"></i></a>
</h2>
<p>The first few lines of the vignette contain important metadata.
The default template contains the following information:</p>
<pre><code>---
title: "Vignette Title"
output: rmarkdown::html_vignette
vignette: &gt;
  %\VignetteIndexEntry{Vignette Title}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---</code></pre>
<p>This metadata is written in <a href="https://yaml.org/">yaml</a>, a format designed to be both human and computer readable.
The basics of the syntax is much like the <code>DESCRIPTION</code> file, where each line consists of a field name, a colon, then the value of the field.
The one special YAML feature we’re using here is <code>&gt;</code>.
It indicates the following lines of text are plain text and shouldn’t use any special YAML features.</p>
<p>The fields are:</p>
<ul>
<li><p><code>title</code> and <code>description</code>.
If you change the title, you must also change the <code>VignetteIndexEntry{}</code> described below.</p></li>
<li><p><code>author</code>: we don’t use this unless the vignette author is different to the package author.</p></li>
<li><p><code>date</code>: don’t recommend this either as it’s very easy to forget to update.
You could use <code>Sys.date()</code>, but this shows when the vignette was built, which might be very different to when it was last updated.</p></li>
<li><p>Output: this tells rmarkdown which output formatter to use.
There are many options that are useful for regular reports (including html, pdf, slideshows, …) but <code><a href="https://pkgs.rstudio.com/rmarkdown/reference/html_vignette.html">rmarkdown::html_vignette</a></code> has been specifically designed to work well inside packages.
See <code><a href="https://pkgs.rstudio.com/rmarkdown/reference/html_vignette.html">?rmarkdown::html_vignette</a></code> for more details.</p></li>
<li><p>Vignette: this contains a special block of metadata needed by R.
Here, you can see the legacy of LaTeX vignettes: the metadata looks like LaTeX commands.
You’ll need to modify the <code>\VignetteIndexEntry</code> to provide the title of your vignette as you’d like it to appear in the vignette index.
Leave the other two lines as is.
They tell R to use <code>knitr</code> to process the file, and that the file is encoded in UTF-8 (the only encoding you should ever use to write vignettes).</p></li>
</ul>
<p>Also includes block to set up some standard options:</p>
<p><code>collapse = TRUE</code> and <code>comment = "#&gt;"</code> are my preferred way of displaying code output.
I usually set these globally by putting the following knitr block at the start of my document.</p>
</div>
<div id="controlling-evaluation" class="section level2" number="16.3">
<h2>
<span class="header-section-number">16.3</span> Controlling evaluation<a class="anchor" aria-label="anchor" href="#controlling-evaluation"><i class="fas fa-link"></i></a>
</h2>
<p>Your vignettes will be evaluated in many different places, not just your computer — CI/CD, CRAN, and users can run on their computers (although not typical).
Need to make sure they work everywhere which can be challenging if your</p>
<p>Any packages used by your vignette must be listed in <code>Imports</code> or <code>Suggests</code> fields.
Generally save to assume that suggest packages will be installed when you vignette is executed.
But if a package is particularly hard to install you might want to safeguard using one of the tools below.</p>
<p>You’re probably already familiar with the chunk option <code>eval = FALSE</code>.
But can also set for all later chunks with <code>knitr::opts_chunk$set(eval = FALSE)</code>.
This is particularly useful for:</p>
<ul>
<li><code>eval = requireNamespace("package")</code></li>
<li><code>eval = !identical(Sys.getenv("foo"), "")</code></li>
<li><code>eval = file.exists("special-key")</code></li>
</ul>
<p>A final option if you want to don’t want to execute at all on CRAN.
Another option is to create an “article”; an Rmd that appears only on the website that’s not embedded in the package.
This makes it slightly less accessible, but it’s fine if you have a pkgdown website.</p>
<p>Many other options are described at <a href="https://yihui.name/knitr/options" class="uri">https://yihui.name/knitr/options</a>.</p>
<p><code>error = TRUE</code> captures any errors in the block and shows them inline.
This is useful if you want to demonstrate what happens if code throws an error.</p>
</div>
<div id="vignette-advice" class="section level2" number="16.4">
<h2>
<span class="header-section-number">16.4</span> Advice<a class="anchor" aria-label="anchor" href="#vignette-advice"><i class="fas fa-link"></i></a>
</h2>
<blockquote>
<p>If you’re thinking without writing, you only think you’re thinking.
— Leslie Lamport</p>
</blockquote>
<p>When writing a vignette, you’re teaching someone how to use your package.
You need to put yourself in the readers’ shoes, and adopt a “beginner’s mind”.
This can be difficult because it’s hard to forget all of the knowledge that you’ve already internalised.
For this reason, we find in-person teaching to be a really useful way to get feedback.
You’re immediately confronted with what you’ve forgotten that only you know.</p>
<p>A useful side effect of this approach is that it helps you improve your code.
It forces you to re-see the initial onboarding process and to appreciate the parts that are hard.
Our experience is that explaining how code works often reveals some problems that need fixing.
(In fact, a key part of the tidyverse package release process is writing a blog post: we now do that before submitting to CRAN because of the number of times it’s revealed some subtle problem that requires a fix).</p>
<p>In the tidyverse, I think we’re generally always a little behind on vignettes and we need more than we currently have.</p>
<p>Writing a vignette also makes a nice break from coding.
Writing seems to use a different part of the brain from programming, so if you’re sick of programming, try writing for a bit.</p>
<div id="writing" class="section level3" number="16.4.1">
<h3>
<span class="header-section-number">16.4.1</span> Writing<a class="anchor" aria-label="anchor" href="#writing"><i class="fas fa-link"></i></a>
</h3>
<ul>
<li><p>I strongly recommend literally anything written by Kathy Sierra.
Her old blog, <a href="https://headrush.typepad.com/">Creating passionate users</a> is full of advice about programming, teaching, and how to create valuable tools.
I thoroughly recommend reading through all the older content.
Her new blog, <a href="https://seriouspony.com/blog/">Serious Pony</a>, doesn’t have as much content, but it has some great articles.</p></li>
<li><p>If you’d like to learn how to write better, I highly recommend <a href="https://amzn.com/0321898680">Style: Lessons in Clarity and Grace</a> by Joseph M. Williams and Joseph Bizup.
It helps you understand the structure of writing so that you’ll be better able to recognise and fix bad writing.</p></li>
</ul>
</div>
<div id="diagrams" class="section level3" number="16.4.2">
<h3>
<span class="header-section-number">16.4.2</span> Diagrams<a class="anchor" aria-label="anchor" href="#diagrams"><i class="fas fa-link"></i></a>
</h3>
<div class="cran">
<p>You’ll need to watch the file size.
If you include a lot of graphics, it’s easy to create a very large file.
Be on the look out for a <code>NOTE</code> that complains about an overly large directory.</p>
</div>
</div>
<div id="organisation-1" class="section level3" number="16.4.3">
<h3>
<span class="header-section-number">16.4.3</span> Organisation<a class="anchor" aria-label="anchor" href="#organisation-1"><i class="fas fa-link"></i></a>
</h3>
<p>For simpler packages, one vignette is often sufficient.
Call it <code>pkgname.Rmd</code>; that takes advantage of a pkgdown convention which will automatically link “Getting Started” to your vignette.</p>
<p>But for more complicated packages you may actually need more than one.
In fact, you can have as many vignettes as you like.
I tend to think of them like chapters of a book – they should be self-contained, but still link together into a cohesive whole.</p>
</div>
<div id="scientific-publication" class="section level3" number="16.4.4">
<h3>
<span class="header-section-number">16.4.4</span> Scientific publication<a class="anchor" aria-label="anchor" href="#scientific-publication"><i class="fas fa-link"></i></a>
</h3>
<p>Vignettes can also be useful if you want to explain the details of your package.
For example, if you have implemented a complex statistical algorithm, you might want to describe all the details in a vignette so that users of your package can understand what’s going on under the hood, and be confident that you’ve implemented the algorithm correctly.
In this case, you might also consider submitting your vignette to the <a href="http://jstatsoft.org/">Journal of Statistical Software</a> or <a href="http://journal.r-project.org/">The R Journal</a>.
Both journals are electronic only and peer-reviewed.
Comments from reviewers can be very helpful for improving your package and vignette.</p>
<p>If you just want to provide something very lightweight so folks have an easy time citing your package you might also consider the <a href="https://joss.theoj.org">Journal of Open Source Software</a>.
This journal has a particularly speedy submission and review process, and is where we published “<a href="https://joss.theoj.org/papers/10.21105/joss.01686"><em>Welcome to the Tidyverse</em></a>”, a paper we wrote so that folks could have a single paper to cite and all the tidyverse authors would get some academic credit.</p>

</div>
</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="man.html"><span class="header-section-number">15</span> Function documentation</a></div>
<div class="next"><a href="important-files.html"><span class="header-section-number">17</span> Other markdown files</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#vignettes"><span class="header-section-number">16</span> Vignettes</a></li>
<li><a class="nav-link" href="#vignette-workflow"><span class="header-section-number">16.1</span> Vignette workflow</a></li>
<li><a class="nav-link" href="#vignette-metadata"><span class="header-section-number">16.2</span> Metadata</a></li>
<li><a class="nav-link" href="#controlling-evaluation"><span class="header-section-number">16.3</span> Controlling evaluation</a></li>
<li>
<a class="nav-link" href="#vignette-advice"><span class="header-section-number">16.4</span> Advice</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#writing"><span class="header-section-number">16.4.1</span> Writing</a></li>
<li><a class="nav-link" href="#diagrams"><span class="header-section-number">16.4.2</span> Diagrams</a></li>
<li><a class="nav-link" href="#organisation-1"><span class="header-section-number">16.4.3</span> Organisation</a></li>
<li><a class="nav-link" href="#scientific-publication"><span class="header-section-number">16.4.4</span> Scientific publication</a></li>
</ul>
</li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/hadley/r-pkgs/blob/main/vignettes.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/hadley/r-pkgs/edit/main/vignettes.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>R Packages</strong>" was written by Hadley Wickham, Jennifer Bryan. </p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer>
</body>
</html>
