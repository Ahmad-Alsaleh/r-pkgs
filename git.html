<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 18 Git and GitHub | R Packages</title>
<meta name="author" content="Hadley Wickham">
<meta name="author" content="Jennifer Bryan">
<meta name="description" content="If you’re serious about software development, you need to learn about Git. Git is a version control system, a tool that tracks changes to your code and shares those changes with others. Git is...">
<meta name="generator" content="bookdown 0.24 with bs4_book()">
<meta property="og:title" content="Chapter 18 Git and GitHub | R Packages">
<meta property="og:type" content="book">
<meta property="og:url" content="https://r-pkgs.org/git.html">
<meta property="og:image" content="https://r-pkgs.org/images/cover.png">
<meta property="og:description" content="If you’re serious about software development, you need to learn about Git. Git is a version control system, a tool that tracks changes to your code and shares those changes with others. Git is...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 18 Git and GitHub | R Packages">
<meta name="twitter:site" content="@hadley">
<meta name="twitter:description" content="If you’re serious about software development, you need to learn about Git. Git is a version control system, a tool that tracks changes to your code and shares those changes with others. Git is...">
<meta name="twitter:image" content="https://r-pkgs.org/images/cover.png">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.3.1/transition.js"></script><script src="libs/bs3compat-0.3.1/tabs.js"></script><script src="libs/bs3compat-0.3.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-141182576-1"></script><script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
  
    gtag('config', 'UA-141182576-1');
  </script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><link rel="stylesheet" href="style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">R Packages</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Welcome!</a></li>
<li><a class="" href="preface.html">Preface</a></li>
<li class="book-part">Getting started</li>
<li><a class="" href="intro.html"><span class="header-section-number">1</span> Introduction</a></li>
<li><a class="" href="whole-game.html"><span class="header-section-number">2</span> The whole game</a></li>
<li><a class="" href="setup.html"><span class="header-section-number">3</span> System setup</a></li>
<li><a class="" href="package-structure-state.html"><span class="header-section-number">4</span> Package structure and state</a></li>
<li><a class="" href="workflows101.html"><span class="header-section-number">5</span> Fundamental development workflows</a></li>
<li><a class="" href="package-within.html"><span class="header-section-number">6</span> The package within</a></li>
<li class="book-part">Package components</li>
<li><a class="" href="r.html"><span class="header-section-number">7</span> R code</a></li>
<li><a class="" href="description.html"><span class="header-section-number">8</span> Package metadata</a></li>
<li><a class="" href="license.html"><span class="header-section-number">9</span> Licensing</a></li>
<li><a class="" href="man.html"><span class="header-section-number">10</span> Object documentation</a></li>
<li><a class="" href="vignettes.html"><span class="header-section-number">11</span> Vignettes: long-form documentation</a></li>
<li><a class="" href="tests.html"><span class="header-section-number">12</span> Testing</a></li>
<li><a class="" href="namespace.html"><span class="header-section-number">13</span> Namespace</a></li>
<li><a class="" href="data.html"><span class="header-section-number">14</span> External data</a></li>
<li><a class="" href="src.html"><span class="header-section-number">15</span> Compiled code</a></li>
<li><a class="" href="inst.html"><span class="header-section-number">16</span> Installed files</a></li>
<li><a class="" href="misc.html"><span class="header-section-number">17</span> Other components</a></li>
<li class="book-part">Sharing with others</li>
<li><a class="active" href="git.html"><span class="header-section-number">18</span> Git and GitHub</a></li>
<li><a class="" href="r-cmd-check.html"><span class="header-section-number">19</span> Automated checking</a></li>
<li><a class="" href="release.html"><span class="header-section-number">20</span> Releasing a package</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/hadley/r-pkgs">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="git" class="section level1">
<h1>
<span class="header-section-number">18</span> Git and GitHub<a class="anchor" aria-label="anchor" href="#git"><i class="fas fa-link"></i></a>
</h1>
<p>If you’re serious about software development, you need to learn about Git. Git is a <em>version control system</em>, a tool that tracks changes to your code and shares those changes with others. Git is most useful when combined with <a href="https://github.com">GitHub</a>, a website that allows you to share your code with the world, solicit improvements via pull requests and track issues. Git + GitHub is the most popular version control system for developers of R packages (witness the thousands of R packages hosted on GitHub).</p>
<p>Git and GitHub are generally useful for all software development and data analysis, not just R packages. I’ve included it here, because it is so useful when you’re making a package. There’s no way I could be as productive without Git and GitHub at my back, enabling me to rapidly spot mistakes and easily collaborate with others.</p>
<p>Why use Git + GitHub?</p>
<ul>
<li>
<p>It makes sharing your package easy. Any R user can install your package with
just two lines of code:</p>
<div class="sourceCode" id="cb239"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"devtools"</span><span class="op">)</span>
<span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://devtools.r-lib.org//reference/remote-reexports.html">install_github</a></span><span class="op">(</span><span class="st">"username/packagename"</span><span class="op">)</span></code></pre></div>
</li>
<li><p>GitHub is a great way to make a barebones website for your package. Readers
can easily browse code, and read documentation (via Markdown). They can
report bugs, suggest new features with <a href="https://guides.github.com/features/issues/">GitHub issues</a>, and
propose improvements to your code with pull requests.</p></li>
<li><p>Have your ever tried to collaboratively write code with someone by sending
files back and forth via email or a Dropbox folder? It takes a lot of effort
just to make sure that the two of you aren’t working on the same file and
overwriting each others’ changes. With Git, both of you can work on the
same file at the same time. Git will either combine your changes
automatically, or it will show you all the ambiguities and conflicts.</p></li>
<li><p>Have you ever accidentally pressed <code>s</code> instead of Cmd + S to save your
file? It’s very easy to accidentally introduce a mistake that takes a few
minutes to track down. Git makes this problem easy to spot because it
allows you to see exactly what’s changed and undo any mistakes.</p></li>
</ul>
<p>You can do many of these same things with other tools (like <a href="https://subversion.apache.org">subversion</a> or <a href="https://www.mercurial-scm.org/">mercurial</a>) and other websites (like <a href="https://about.gitlab.com">gitlab</a> and <a href="https://bitbucket.org">bitbucket</a>). Git is most useful in conjunction with GitHub, and vice versa, so I’ll make no effort to distinguish between features that belong to Git and those that belong to GitHub. But I think Git + GitHub is the most user-friendly system (especially for new developers), not least because its popularity means that the answer or solution to every possible question or problem can be found on StackOverflow.</p>
<p>This is not to say that Git is easy to learn. Your initial experiences with Git are likely to be frustrating and you will frequently curse at the strange terminology and unhelpful error messages. Fortunately, there are many tutorials available online, and while they aren’t always well written (many provide a lot of information but little guidance about what to do with it or why you need to care), you can absolutely master Git with a little practice. Don’t give up! Persevere and you’ll unlock the super-power of code collaboration.</p>
<div id="git-rstudio" class="section level2">
<h2>
<span class="header-section-number">18.1</span> RStudio, Git and GitHub<a class="anchor" aria-label="anchor" href="#git-rstudio"><i class="fas fa-link"></i></a>
</h2>
<p>RStudio makes day-to-day use of Git simpler. Once you’ve set up a project to use Git, you’ll see a new pane and toolbar icon. These provide shortcuts to the most commonly used Git commands. However, because only a handful of the 150+ Git commands are available in RStudio, you also need to be familiar with using Git from the <strong>shell</strong> (aka the command line or the console). It’s also useful to be familiar with using Git in a shell because if you get stuck you’ll need to search for a solution with the Git command names.</p>
<p>The easiest way to get to a shell from RStudio is Tools &gt; Shell. This will open a new shell located in the root directory of your project. (NB: on Windows, this opens up a <em>bash</em> shell, the standard Linux shell, which behaves a little differently from the usual <code>cmd.exe</code> shell.)</p>
<p>Don’t worry if you’ve never used the shell before because it’s very similar to using R. The main difference is that instead of functions, you call commands, which have a slightly different syntax. For example, in R you might write <code>f(x, y = 1)</code>, where in the shell you’d write <code>f x --y=1</code> or <code>f x -y1</code>. Also, while shell commands are even less regular than R functions, you fortunately only need to be familiar with a few. In this chapter, you won’t be doing much in the shell apart from running Git commands. However, it’s a good idea to learn the three most important shell commands:</p>
<ul>
<li>
<code>pwd</code>: print working directory. This tells you which directory you’re currently in.</li>
<li>
<code>cd &lt;name&gt;</code>: change directory. Use <code>cd ..</code> to move up the directory hierarchy.</li>
<li>
<code>ls</code>: list files. Shows all files in the current directory.</li>
</ul>
<p>If you’ve never used the shell before, I recommend playing <a href="https://web.mit.edu/mprat/Public/web/Terminus/Web/main.html">Terminus</a>. It’s a fun way to learn the basics of the shell. I also recommend taking a look at Philip Guo’s <a href="http://pgbovine.net/command-line-tutorial.htm">Basic Unix-like command line tutorial</a> videos, and at <a href="http://www.ee.surrey.ac.uk/Teaching/Unix/unix1.html" class="uri">http://www.ee.surrey.ac.uk/Teaching/Unix/unix1.html</a> and <a href="https://p1k3.com/userland-book/" class="uri">https://p1k3.com/userland-book/</a>.</p>
</div>
<div id="git-setup" class="section level2">
<h2>
<span class="header-section-number">18.2</span> Initial set up<a class="anchor" aria-label="anchor" href="#git-setup"><i class="fas fa-link"></i></a>
</h2>
<p>If you’ve never used Git or GitHub before, start by installing Git and creating a GitHub account. Then, link the two together:</p>
<ol style="list-style-type: decimal">
<li>
<p>Install Git:</p>
<ul>
<li>Windows: <a href="https://git-scm.com/download/win" class="uri">https://git-scm.com/download/win</a>.</li>
<li>OS X: <a href="https://git-scm.com/download/mac" class="uri">https://git-scm.com/download/mac</a>.</li>
<li>Debian/Ubuntu: <code>sudo apt-get install git-core</code>.</li>
<li>Other Linux distros: <a href="https://git-scm.com/download/linux" class="uri">https://git-scm.com/download/linux</a>.</li>
</ul>
</li>
<li>
<p>Tell Git your name and email address. These are used to label each commit
so that when you start collaborating with others, it’s clear who made
each change. In the shell, run:</p>
<div class="sourceCode" id="cb240"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb240-1"><a href="git.html#cb240-1"></a><span class="fu">git</span> config --global user.name <span class="st">"YOUR FULL NAME"</span></span>
<span id="cb240-2"><a href="git.html#cb240-2"></a><span class="fu">git</span> config --global user.email <span class="st">"YOUR EMAIL ADDRESS"</span></span></code></pre></div>
<p>(You can check if you’re set up correctly by running
<code>git config --global --list</code>.)</p>
</li>
<li><p>Create an account on GitHub, <a href="https://github.com" class="uri">https://github.com</a> (the free plan is fine).
Use the same email address as above.</p></li>
<li>
<p>If needed, generate a SSH key. SSH keys allow you to securely
communicate with websites without a password. There are two parts to
an SSH key: one public, one private. People with your public key can
securely encrypt data that can only be read by someone with your
private key.</p>
<p>From R, you can check if you already have an SSH key-pair by running:</p>
<div class="sourceCode" id="cb241"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/files.html">file.exists</a></span><span class="op">(</span><span class="st">"~/.ssh/id_rsa.pub"</span><span class="op">)</span></code></pre></div>
<p>If that returns <code>FALSE</code>, you’ll need to create a new key. You can either follow the
<a href="https://help.github.com/articles/generating-ssh-keys">instructions on GitHub</a>
or use RStudio. Go to RStudio’s global options, choose the Git/SVN panel, and
click “Create RSA key…”:</p>
<div class="inline-figure">
<img src="images/git-config-2.png"><!-- -->
</div>
</li>
<li><p>Give GitHub your SSH public key: <a href="https://github.com/settings/ssh" class="uri">https://github.com/settings/ssh</a>.
The easiest way to find the key is to click “View public key” in
RStudio’s Git/SVN preferences pane.</p></li>
</ol>
</div>
<div id="git-init" class="section level2">
<h2>
<span class="header-section-number">18.3</span> Create a local Git repository<a class="anchor" aria-label="anchor" href="#git-init"><i class="fas fa-link"></i></a>
</h2>
<p>Now that you have installed and configured Git, you can use it! To use GitHub with your package, you’ll need to initialise a local repository, or <strong>repo</strong> for short. This creates a <code>.git</code> directory that stores configuration files and a database that records changes to your code. A new repo exists only on your computer; you’ll learn how to share it with others shortly.</p>
<p>To create a new repo:</p>
<ul>
<li>
<p>In RStudio, go to project options, then to the Git/SVN panel. Change the
“Version control system” from “None” to “Git”:</p>
<div class="inline-figure">
<img src="images/git-proj-config.png"><!-- -->
</div>
<p>You’ll then be prompted to restart RStudio.</p>
</li>
<li><p>In a shell, run <code>git init</code>. Restart RStudio and reopen your package.</p></li>
</ul>
<p>Once Git has been initialised, you’ll see two new components:</p>
<ul>
<li>
<p>The <strong>git pane</strong>, at the top-right, shows you what files have
changed and includes buttons for the most important Git commands:</p>
<div class="inline-figure">
<img src="images/git-pane.png"><!-- -->
</div>
</li>
<li>
<p>The <strong>git dropdown</strong> menu, found in the toolbar, includes Git and GitHub commands
that apply to the current file:</p>
<div class="inline-figure">
<img src="images/git-dropdown.png"><!-- -->
</div>
</li>
</ul>
</div>
<div id="git-status" class="section level2">
<h2>
<span class="header-section-number">18.4</span> See what’s changed<a class="anchor" aria-label="anchor" href="#git-status"><i class="fas fa-link"></i></a>
</h2>
<p>The first benefit of Git is that you can easily see the changes you’ve made. I find this really helpful, as I often accidentally mistype keyboard shortcuts, leaving stray characters in my code. The RStudio Git pane lists every file that’s been added, modified or deleted. The icon describes the change:</p>
<ul>
<li><p><img src="images/git-modified.png"><!-- -->,
<strong>Modified</strong>. You’ve changed the contents of the file.</p></li>
<li><p><img src="images/git-unknown.png"><!-- -->,
<strong>Untracked</strong>. You’ve added a new file that Git hasn’t seen before.</p></li>
<li><p><img src="images/git-deleted.png"><!-- -->,
<strong>Deleted</strong>. You’ve deleted a file.</p></li>
</ul>
<p>You can get more details about modifications with a “diff”, <img src="images/git-diff.png"><!-- -->. This opens a new window showing the detailed <strong>diff</strong>erences:</p>
<div class="inline-figure">
<img src="images/git-diff-window.png"><!-- -->
</div>
<p>The background colours tells you whether the text has been added (green) or removed (red). (If you’re colourblind you can use the line numbers in the two columns at the far left as a guide: a number in the first column identifies the old version, a number in second column identifies the new version.) The grey lines of code above and below the changes give you additional context.</p>
<p>In the shell, use <code>git status</code> to see an overview of changes and <code>git diff</code> to show detailed differences.</p>
</div>
<div id="git-commit" class="section level2">
<h2>
<span class="header-section-number">18.5</span> Record changes<a class="anchor" aria-label="anchor" href="#git-commit"><i class="fas fa-link"></i></a>
</h2>
<p>The fundamental unit of work in Git is a <strong>commit</strong>. A commit takes a snapshot of your code at a specified point in time. Using a Git commit is like using anchors and other protection when climbing. If you’re crossing a dangerous rock face you want to make sure you’ve used protection to catch you if you fall. Commits play a similar role: if you make a mistake, you can’t fall past the previous commit. Coding without commits is like free-climbing: you can travel much faster in the short-term, but in the long-term the chances of catastrophic failure are high! Like rock climbing protection, you want to be judicious in your use of commits. Committing too frequently will slow your progress; use more commits when you’re in uncertain or dangerous territory. Commits are also helpful to others, because they show your journey, not just the destination.</p>
<p>There are five key components to every commit:</p>
<ul>
<li><p>A unique identifier, called a SHA (short for secure hash algorithm).</p></li>
<li><p>A changeset that describes which files were added, modified and deleted.</p></li>
<li><p>A human-readable commit message.</p></li>
<li><p>A parent, the commit that came before this one. (There are two exceptions to
this rule: the initial commit doesn’t have a parent, and merges, which you’ll
learn about later, have two parents.)</p></li>
<li><p>An author.</p></li>
</ul>
<p>You create a commit in two stages:</p>
<ol style="list-style-type: decimal">
<li><p>You <strong>stage</strong> files, telling Git which changes should be included in the
next commit.</p></li>
<li><p>You <strong>commit</strong> the staged files, describing the changes with a message.</p></li>
</ol>
<div class="inline-figure">In RStudio, staging and committing are done in the same place, the commit window, which you can open by clicking <img src="images/git-commit.png"><!-- --> or by pressing Ctrl + Alt + m.</div>
<div class="inline-figure">
<img src="images/git-commit-window.png"><!-- -->
</div>
<p>The commit window is made up of three panes:</p>
<ul>
<li><p>The top-left pane shows the current status in the way as the Git pane in the
main RStudio window.</p></li>
<li><p>The bottom pane shows the diff of the currently selected file.</p></li>
<li><p>The top-right pane is where you’ll enter the commit message, a human
readable message summarising the changes made in the commit. More on
that shortly.</p></li>
</ul>
<div class="inline-figure">(Yes, this is exactly the same window you see when clicking <img src="images/git-diff.png"><!-- -->!)</div>
<p>To create a new commit:</p>
<ol style="list-style-type: decimal">
<li><p><strong>Save your changes</strong>.</p></li>
<li><p><strong>Open the commit window</strong> by clicking
<img src="images/git-commit.png"><!-- --> or
pressing <code>Ctrl + Alt + m</code>.</p></li>
<li>
<p><strong>Select files</strong>. To stage (select) a single file for inclusion, tick its
check box. To stage all files, press Ctrl/Cmd + A, then click
<img src="images/git-stage.png"><!-- -->.</p>
<p>As you stage each file, you’ll notice that its status changes. The icon
will change columns from right (unstaged status) to left (staged status),
and you might see one of two new icons:</p>
<ul>
<li><div class="inline-figure">Added: <img src="images/git-added.png"><!-- -->:
after staging an untracked file, Git now knows that you want to add it
to the repo.</div></li>
<li><div class="inline-figure">Renamed: <img src="images/git-renamed.png"><!-- -->:
If you rename a file, Git initially sees it as a deletion and addition.
Once you stage both changes, Git will recognise that it’s a rename.</div></li>
</ul>
<div class="inline-figure">Sometimes you’ll see a status in both columns, e.g. 
<img src="images/git-modified-staged.png"><!-- -->.
This means that you have both staged and unstaged changes in the same file.
This happens when you’ve made some changes, staged them, and then made some
more. Clicking the staged checkbox will stage your new changes, clicking
it again will unstage both sets of changes.</div>
</li>
<li><p><strong>Stage files</strong>, as above.</p></li>
<li><p><strong>Write a commit message</strong> (top-right panel) which describes the changes
that you’ve made. The first line of a commit message is called the subject
line and should be brief (50 characters or less). For complicated commits,
you can follow it with a blank line and then a paragraph or bulleted list
providing more detail. Write messages in imperative, like you’re telling
someone what to do: “fix this bug”, not “fixed this bug” or
“this bug was fixed”.</p></li>
<li><p><strong>Click Commit</strong>.</p></li>
</ol>
<p>Staging files is a little more complicated in the shell. You use <code>git add</code> to stage new and modified files, and <code>git rm</code> to stage deleted files. To create the commit, use <code>git commit -m &lt;message&gt;</code>.</p>
</div>
<div id="commit-best-practices" class="section level2">
<h2>
<span class="header-section-number">18.6</span> Commit best practices<a class="anchor" aria-label="anchor" href="#commit-best-practices"><i class="fas fa-link"></i></a>
</h2>
<p>Ideally, each commit should be <em>minimal</em> but <em>complete</em>:</p>
<ul>
<li><p><strong>Minimal</strong>: A commit should only contain changes related to a single
problem. This will make it easier to understand the commit at a glance, and to
describe it with a simple message. If you should discover a new problem, you
should do a separate commit.</p></li>
<li><p><strong>Complete</strong>: A commit should solve the problem that it claims to solve.
If you think you’ve fixed a bug, the commit should contain a unit test
that confirms you’re right.</p></li>
</ul>
<p>Each commit message should:</p>
<ul>
<li><p><strong>Be concise, yet evocative</strong>. At a glance, you should be able to see
what a commit does. But there should be enough detail so you can remember
(and understand) what was done.</p></li>
<li><p><strong>Describe the why, not the what</strong>. Since you can always retrieve the diff
associated with a commit, the message doesn’t need to say exactly what
changed. Instead it should provide a high-level summary that focuses on the
reasons for the change.</p></li>
</ul>
<p>If you do this:</p>
<ul>
<li><p>It’ll be easier to work with others. For example, if two people have changed
the same file in the same place, it’ll be easier to resolve conflicts if the
commits are small and it’s clear why each change was made.</p></li>
<li><p>Project newcomers can more easily understand the history by reading the commit
logs.</p></li>
<li><p>You can load and run your package at any point along its development history.
This can be tremendously useful with tools like
<a href="https://github.com/wch/bisectr">bisectr</a>, which allow you to use binary
search to quickly find the commit that introduced a bug.</p></li>
<li><p>If you can figure out exactly when a bug was introduced, you can easily
understand what you were doing (and why!).</p></li>
</ul>
<p>You might think that because no one else will ever look at your repo, that writing good commit messages is not worth the effort. But keep in mind that you have one very important collaborator: future-you! If you spend a little time now polishing your commit messages, future-you will thank you if and when they need to do a post-mortem on a bug.</p>
<p>Remember that these directives are aspirational. You shouldn’t let them get in your way. If you look at the commit history of my repositories, you’ll notice a lot of them aren’t that good, especially when I start to get frustrated that I <strong>still</strong> haven’t managed to fix a bug. Strive to follow these guidelines, and remember it’s better to have multiple bad commits than to have one perfect commit.</p>
</div>
<div id="git-ignore" class="section level2">
<h2>
<span class="header-section-number">18.7</span> Ignoring files<a class="anchor" aria-label="anchor" href="#git-ignore"><i class="fas fa-link"></i></a>
</h2>
<p>Often, there are files that you don’t want to include in the repository. They might be transient (like LaTeX or C build artefacts), very large, or generated on demand. Rather than carefully <em>not</em> staging them each time, you should instead add them to <code>.gitignore</code>. This will prevent them from accidentally being added. The easiest way to do this is to right-click on the file in the Git pane and select <code>Ignore</code>:</p>
<div class="inline-figure">
<img src="images/git-ignore.png"><!-- -->
</div>
<p>If you want to ignore multiple files, you can use a wildcard “glob” like <code>*.png</code>. To learn more about the options, see <a href="https://git-scm.com/book/ch2-2.html#Ignoring-Files">ignoring files</a> in Pro-Git.</p>
<p>Some developers never commit derived files, files that can be generated automatically. For an R package this would mean ignoring the files in the <code>NAMESPACE</code> and <code>man/</code> directories because they’re generated from comments. From a practical pespective, it’s better to commit these files: R packages have no way to generate <code>.Rd</code> files on installation so ignoring derived files means that users who install your package from GitHub will have no documentation.</p>
</div>
<div id="git-undo" class="section level2">
<h2>
<span class="header-section-number">18.8</span> Undo a mistake<a class="anchor" aria-label="anchor" href="#git-undo"><i class="fas fa-link"></i></a>
</h2>
<p>The best thing about using commits is that you can undo mistakes. RStudio makes it particularly easy:</p>
<ul>
<li>
<p>To undo the changes you’ve just made, right click on the file in the Git
pane and select “revert”. This will roll any changes back to the previous
commit. Beware: you can’t undo this operation!</p>
<p>You can also undo changes to just part of a file in the diff window. Look
for a <strong>discard chunk</strong> button above the block of changes that you want to
undo:<img src="images/git-chunk.png"><!-- -->. You
can also discard changes to individual lines or selected text.</p>
</li>
<li><div class="inline-figure">If you committed changes too early, you can modify the previous commit by
staging the extra changes. Before you click commit, select
<img src="images/git-commit-amend.png"><!-- -->.
(Don’t do this if you’ve pushed the previous commit to GitHub - you’re
effectively rewriting history, which should be done with care when you’re
doing it in public.)</div></li>
</ul>
<p>If you didn’t catch the mistake right away, you’ll need to look backwards in history and find out where it occurred:</p>
<ol style="list-style-type: decimal">
<li>
<div class="inline-figure">Open the history window by clicking
<img src="images/git-history.png"><!-- --> in the
Git pane.</div>
<div class="inline-figure">
<img src="images/git-history-window.png"><!-- -->
</div>
<p>The history window is divided into two parts. The top part lists every
commit to your repo. The bottom part shows you the commit:
the SHA (the unique id), the author, the date, the parent and
the changes in the commit.</p>
</li>
<li><p>Navigate back in time until you find the commit where the mistake occurred.
Write down the parent SHA: that’s the commit that occurred before the
mistake so it will be good.</p></li>
</ol>
<p>Now you can use that SHA in the shell:</p>
<ul>
<li>
<p>See what the file looked like in the past so you can copy-and-paste the old
code:</p>
<div class="sourceCode" id="cb242"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb242-1"><a href="git.html#cb242-1"></a><span class="fu">git</span> show <span class="op">&lt;</span>SHA<span class="op">&gt;</span> <span class="op">&lt;</span>filename<span class="op">&gt;</span></span></code></pre></div>
</li>
<li>
<p>Or copy the version from the past back in to the present:</p>
<div class="sourceCode" id="cb243"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb243-1"><a href="git.html#cb243-1"></a><span class="fu">git</span> checkout <span class="op">&lt;</span>SHA<span class="op">&gt;</span> <span class="op">&lt;</span>filename<span class="op">&gt;</span></span></code></pre></div>
</li>
</ul>
<p>In both cases you’ll need to finish by staging and committing the files.</p>
<p>(It’s also possible to use Git as if you went back in time and prevented the mistake from happening in the first place. This is an advanced technique called <strong>rebasing history</strong>. As you might imagine, going back in time to change the past can have a profound impact on the present. It can be useful, but it needs to be done with extreme care.)</p>
<p>If you’re still stuck, try <a href="https://sethrobertson.github.io/GitFixUm/fixup.html" class="uri">https://sethrobertson.github.io/GitFixUm/fixup.html</a> or <a href="http://justinhileman.info/article/git-pretty/" class="uri">http://justinhileman.info/article/git-pretty/</a>. They give step-by-step approaches to fixing many common (and not so common!) problems.</p>
</div>
<div id="github-init" class="section level2">
<h2>
<span class="header-section-number">18.9</span> Synchronising with GitHub<a class="anchor" aria-label="anchor" href="#github-init"><i class="fas fa-link"></i></a>
</h2>
<p>So far we’ve only been working locally, using commits to track the progress of a project and to provide safe checkpoints. However, Git really shines when you start sharing your code with others with <a href="http://github.com">GitHub</a>. While there are other choices, I recommend GitHub because it is free for open source projects, it has all the features you’ll need, and is a popular choice in the R world.</p>
<p>To publish, or <strong>push</strong>, your code to GitHub:</p>
<ol style="list-style-type: decimal">
<li><p>Create a new repo on GitHub: <a href="https://github.com/new" class="uri">https://github.com/new</a>. Give it the same
name as your package, and include the package title as the repo
description. Leave all the other options as is, then click Submit.</p></li>
<li>
<p>Open a shell, then follow the instructions on the new repo page.
They’ll look something like this:</p>
<div class="sourceCode" id="cb244"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb244-1"><a href="git.html#cb244-1"></a><span class="fu">git</span> remote add origin git@github.com:hadley/r-pkgs.git</span>
<span id="cb244-2"><a href="git.html#cb244-2"></a><span class="fu">git</span> push -u origin master</span></code></pre></div>
<p>The first line tells Git that your local repo has a remote version on
GitHub, and calls it “origin”. The second line pushes all your current
work to that repo.</p>
</li>
</ol>
<p>Now let’s make a commit and verify that the remote repo updates:</p>
<ol style="list-style-type: decimal">
<li>
<p>Modify <code>DESCRIPTION</code> to add <code>URL</code> and <code>BugReports</code> fields that link
to your new GitHub site. For example, dplyr has:</p>
<div class="sourceCode" id="cb245"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb245-1"><a href="git.html#cb245-1"></a><span class="fu">URL</span><span class="kw">:</span><span class="at"> https://github.com/hadley/dplyr</span></span>
<span id="cb245-2"><a href="git.html#cb245-2"></a><span class="fu">BugReports</span><span class="kw">:</span><span class="at"> https://github.com/hadley/dplyr/issues</span></span></code></pre></div>
</li>
<li><p>Save the file and commit (with the message “Updating DESCRIPTION to add
links to GitHub site”).</p></li>
<li><p><strong>Push</strong> your changes to GitHub by clicking
<img src="images/git-push.png"><!-- -->. (This is
the same as running <code>git push</code> in the shell).</p></li>
<li><p>Go to your GitHub page and look at the <code>DESCRIPTION</code>.</p></li>
</ol>
<p>Usually, each push will include multiple commits. This is because you push much less often than you commit. How often you push versus commit is completely up to you, but pushing code means publishing code. So strive to push code that works.</p>
<p>To ensure your code is clean, I recommend always running <code>R CMD check</code> before you push (a topic you’ll learn about in the chapter on <a href="whole-game.html#check">automated checking</a>). If you want to publish code that doesn’t work (yet), I recommend using a branch, as you’ll learn about below in <a href="git.html#git-branch">branching</a>.</p>
<div class="inline-figure">Once you’ve connected your repo to GitHub, the Git pane will show you how many commits you have locally that are not on GitHub: <img src="images/git-local-commits.png"><!-- -->. This message indicates that I have 1 commit locally (my branch) that is not on GitHub (“origin/master”).</div>
</div>
<div id="github-benefit" class="section level2">
<h2>
<span class="header-section-number">18.10</span> Benefits of using GitHub<a class="anchor" aria-label="anchor" href="#github-benefit"><i class="fas fa-link"></i></a>
</h2>
<ol style="list-style-type: decimal">
<li><p>You get a decent website. The GitHub page for your project, e.g. 
<a href="https://github.com/hadley/testthat" class="uri">https://github.com/hadley/testthat</a> (the GitHub repo for testthat), lists
all the files and directories in your package. <code>.R</code> files will be formatted
with syntax highlighting, and <code>.md</code>/<code>.Rmd</code> files will be rendered as HTML.
And, if you include a <code>README.md</code> file in the top-level directory, it will
be displayed on the homepage. You’ll learn more about the benefits of
creating this file in <a href="release.html#readme">README.md</a>.</p></li>
<li>
<p>It makes it easy for anyone to install your package (and to benefit from your
hard work):</p>
<div class="sourceCode" id="cb246"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://devtools.r-lib.org//reference/remote-reexports.html">install_github</a></span><span class="op">(</span><span class="st">"&lt;your_username&gt;/&lt;your_package&gt;"</span><span class="op">)</span></code></pre></div>
</li>
<li><p>You can track the history of the project in the commit view, e.g. 
<a href="https://github.com/hadley/testthat/commits/master" class="uri">https://github.com/hadley/testthat/commits/master</a>. When I’m working on
a package with others, I often keep this page open so I can see what
they’re working on. Individual commits show the same information that you
see in the commit/diff window in RStudio.</p></li>
<li>
<p>It’s easy to see the history of a file. If you navigate to a file and click
<strong>History</strong>, you’ll see every commit that affected that file. Another useful
view is <strong>Blame</strong>; it shows the last change made to each line of code, who
made the change, and the commit the change belongs to. This is tremendously
helpful when you’re tracking down a bug.</p>
<p>You can jump directly to these pages from RStudio with the Git dropdown in
the main toolbar:</p>
<div class="inline-figure">
<img src="images/git-dropdown.png"><!-- -->
</div>
</li>
<li><div class="inline-figure">You can comment on commits. To comment on the commit as a whole, use the
comment box at the bottom of the page. To comment on an individual line,
click the plus sign that appears when you mouse over a line number,
<img src="images/github-comment-line.png"><!-- -->.
This is a great way to let your collaborators know if you see a mistake or
have a question. It’s better than email because it’s public so anyone
working on the repo (both present and future) can see the conversation.</div></li>
</ol>
</div>
<div id="git-pull" class="section level2">
<h2>
<span class="header-section-number">18.11</span> Working with others<a class="anchor" aria-label="anchor" href="#git-pull"><i class="fas fa-link"></i></a>
</h2>
<p>You use <strong>push</strong> to send your changes to GitHub. If you’re working with others, they also push their changes to GitHub. But, to see their changes locally you’ll need to <strong>pull</strong> their changes from GitHub. In fact, to make sure everyone is in sync, Git will only let you push to a repo if you’ve retrieved the most recent version with a pull.</p>
<p>When you pull, Git first downloads (<strong>fetches</strong>) all of the changes and then <strong>merges</strong> them with the changes that you’ve made. A merge is a commit with two parents. It takes two different lines of development and combines them into a single result. In many cases, Git can do this automatically: for example, when changes are made to different files, or to different parts of the same file. However, if changes are made to the same place in a file, you’ll need to resolve the <strong>merge conflict</strong> yourself.</p>
<p>In RStudio, you’ll discover that you have merge conflict when:</p>
<ul>
<li><p>A pull fails with an error.</p></li>
<li><div class="inline-figure">In the Git pane, you see a status like
<img src="images/git-commit-conflict.png"><!-- -->
</div></li>
</ul>
<p>RStudio currently doesn’t provide any tools to help with merge conflicts, so you’ll need to use the command line. I recommend starting by setting your merge conflict “style” to <code>diff3</code>. The <code>diff3</code> style shows three things when you get a merge conflict: your local changes, the original file and the remote changes. The default style is <code>diff2</code>, which only shows your changes and the remote changes. This generally makes it harder to figure out what’s happened.</p>
<ul>
<li>
<p>If you’ve encountered your first merge conflict, do the following:</p>
<div class="sourceCode" id="cb247"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb247-1"><a href="git.html#cb247-1"></a><span class="co"># Abort this merge</span></span>
<span id="cb247-2"><a href="git.html#cb247-2"></a><span class="fu">git</span> merge --abort</span>
<span id="cb247-3"><a href="git.html#cb247-3"></a><span class="co"># Set the conflict style</span></span>
<span id="cb247-4"><a href="git.html#cb247-4"></a><span class="fu">git</span> config --global merge.conflictstyle diff3</span>
<span id="cb247-5"><a href="git.html#cb247-5"></a><span class="co"># Re-try the merge</span></span>
<span id="cb247-6"><a href="git.html#cb247-6"></a><span class="fu">git</span> pull</span></code></pre></div>
</li>
<li>
<p>If you’re not in the middle of a merge conflict, just run</p>
<div class="sourceCode" id="cb248"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb248-1"><a href="git.html#cb248-1"></a><span class="fu">git</span> config --global merge.conflictstyle diff3</span></code></pre></div>
</li>
</ul>
<div class="inline-figure">To resolve a merge conflict, you need to open every file with the status <img src="images/git-commit-conflict.png"><!-- -->. In each file, you’ll find a conflict marker that looks like this:</div>
<pre><code>&lt;&lt;&lt;&lt;&lt;&lt;&lt; HEAD

||||||| merged common ancestors

=======

&gt;&gt;&gt;&gt;&gt;&gt;&gt; remote</code></pre>
<p>This shows all three versions of the conflicting code:</p>
<ul>
<li><p>At the top, your local code.</p></li>
<li><p>In the middle, the code from the last commit before the split between the
two lines of development (This is missing in the default conflict
style, so if you don’t see it, follow the instructions above).</p></li>
<li><p>At the bottom, the remote code that you pulled down from GitHub.</p></li>
</ul>
<p>You need to work through each conflict and decide either which version is better, or how to combine both versions. Then, before you stage the file, make sure you’ve deleted all the conflict markers. Once you’ve fixed all conflicts, make a new commit and push to GitHub.</p>
<p>A couple of pointers when fixing text generated by roxygen:</p>
<ul>
<li><p>Don’t fix problems in <code>man/*.Rd</code> files. Instead, resolve any conflicts in
the underlying roxygen comments and re-document the package.</p></li>
<li><p>Merge conflicts in the <code>NAMESPACE</code> file will prevent you from re-loading or
re-documenting a package. Resolve them enough so that the package
can be loaded, then re-document to generate a clean and correct <code>NAMESPACE</code>.</p></li>
</ul>
<p>Handling merge conflicts is one of the trickier parts of Git. You may need to read a few tutorials before you get the hang of it. Google and StackOverflow are great resources. If you get terribly confused, you can always abort the merge and try again by running <code>git merge --abort</code> then <code>git pull</code>.</p>
</div>
<div id="github-issues" class="section level2">
<h2>
<span class="header-section-number">18.12</span> Issues<a class="anchor" aria-label="anchor" href="#github-issues"><i class="fas fa-link"></i></a>
</h2>
<p>Every GitHub repo comes with a page for tracking issues. Use it! If you encounter a bug while working on another project, jot a note down on the issues page. When you have a smaller project, don’t worry too much about milestones, tags and assigning issues to specific people. Those are more useful once you get over a page of issues (&gt;50). Once you get to that point, read the GitHub guide on issues: <a href="https://guides.github.com/features/issues/" class="uri">https://guides.github.com/features/issues/</a>.</p>
<p>A useful technique is closing issues from a commit message. Just put <code>Closes #&lt;issue number&gt;</code> somewhere in your commit message and GitHub will close the issue for you when you next push. The best thing about closing issues this way is that it makes a link from the issue to the commit. This is useful if you ever have to come back to the bug and want to see exactly what you did to fix it. You can also link to issues without closing them; just refer to <code>#&lt;issue number&gt;</code>.</p>
<p>As you’ll learn about in <a href="release.html#news">NEWS.md</a>, it’s a good idea to add a bullet to <code>NEWS.md</code> whenever you close an issue. The bullet point should describe the issue in terms that users will understand, as opposed to the commit message which is written for developers.</p>
</div>
<div id="git-branch" class="section level2">
<h2>
<span class="header-section-number">18.13</span> Branches<a class="anchor" aria-label="anchor" href="#git-branch"><i class="fas fa-link"></i></a>
</h2>
<p>Sometimes you want to make big changes to your code without having to disturb your main stream of development. Maybe you want to break it up into multiple simple commits so you can easily track what you’re doing. Maybe you’re not sure what you’ve done is the best approach and you want someone else to review your code. Or, maybe you want to try something experimental (you can merge it back only if the experiment succeeds). Branches and pull requests provide powerful tools to handle these situations.</p>
<p>Although you haven’t realised it, you’re already using branches. The default branch is called <strong>master</strong>; it’s where you’ve been saving your commits. If you synchronise your code to GitHub you’ll also have a branch called <strong>origin/master</strong>: it’s a local copy of all the commits on GitHub, which gets synchronised when you pull. <code>git pull</code> does two things:</p>
<ol style="list-style-type: decimal">
<li><p><code>git fetch origin master</code> to update the local <code>origin/master</code> branch with
the latest commits from GitHub.</p></li>
<li><p><code>git merge origin/master</code> to combine the remote changes with your changes.</p></li>
</ol>
<p>It’s useful to create your own branches when you want to (temporarily) break away from the main stream of development. You can create a new branch with <code>git checkout -b &lt;branch-name&gt;</code>. Names should be in lower case letters and numbers, with <code>-</code> used to separate words.</p>
<p>Switch between branches with <code>git checkout &lt;branch-name&gt;</code>. For example, to return to the main line of development use <code>git checkout master</code>. You can also use the branch switcher at the top right of the Git pane:</p>
<div class="inline-figure">
<img src="images/git-branch.png"><!-- -->
</div>
<p>If you’ve forgotten the name of your branch in the shell, you can use <code>git branch</code> to list all existing branches.</p>
<div class="inline-figure">If you try to synchronise this branch to GitHub from inside RStudio, you’ll notice that push and pull are disabled: <img src="images/git-no-remote.png"><!-- -->. To enable them, you’ll need to first tell Git that your local branch has a remote equivalent:</div>
<div class="sourceCode" id="cb250"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb250-1"><a href="git.html#cb250-1"></a><span class="fu">git</span> push --set-upstream origin <span class="op">&lt;</span>branch-name<span class="op">&gt;</span></span></code></pre></div>
<p>After you’ve done that once, you can use the pull and push buttons as usual.</p>
<p>If you’ve been working on a branch for a while, other work might have been going on in the master branch. To integrate that work into your branch, run <code>git merge master</code>. You will need to resolve any merge conflicts (see above). It’s best to do this fairly frequently - the less your branch diverges from the master, the easier it will be to merge.</p>
<p>Once you’re done working on a branch, merge it back into the master, then delete the branch:</p>
<div class="sourceCode" id="cb251"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb251-1"><a href="git.html#cb251-1"></a><span class="fu">git</span> checkout master</span>
<span id="cb251-2"><a href="git.html#cb251-2"></a><span class="fu">git</span> merge <span class="op">&lt;</span>branch-name<span class="op">&gt;</span></span>
<span id="cb251-3"><a href="git.html#cb251-3"></a><span class="fu">git</span> branch -d <span class="op">&lt;</span>branch-name<span class="op">&gt;</span></span></code></pre></div>
<p>(Git won’t let you delete a branch unless you’ve merged it back into the master branch. If you do want to abandon a branch without merging it, you’ll need to force delete with <code>-D</code> instead of <code>-d</code>. If you accidentally delete a branch, don’t panic. It’s usually possible to get it back. See the advice about undoing mistakes).</p>
</div>
<div id="git-pullreq" class="section level2">
<h2>
<span class="header-section-number">18.14</span> Making a pull request<a class="anchor" aria-label="anchor" href="#git-pullreq"><i class="fas fa-link"></i></a>
</h2>
<p>A pull request is a tool for proposing and discussing changes before merging them into a repo. The most common use for a pull request is to contribute to someone else’s code: it’s the easiest way to propose changes to code that you don’t control.</p>
<p>Below, you’ll learn about pull requests to make changes to your own code. This may seem a bit pointless because you don’t <em>need</em> them, as you can directly modify your code. But pull requests are surprisingly useful because they allow you to get feedback on proposed changes. We use them frequently at RStudio to get feedback before merging major changes.</p>
<p>GitHub has some good documentation on using pull requests: <a href="https://help.github.com/articles/using-pull-requests/" class="uri">https://help.github.com/articles/using-pull-requests/</a>. In this chapter, I’ll focus on the basics you need to know to use pull requests effectively, and show you how they fit in with the Git commands you’ve learned so far.</p>
<p>To create a pull request, you create a branch, commit code, then push the branch to GitHub. When you next go to the GitHub website you’ll see a header that invites you to submit a pull request. You can also do it by:</p>
<ol style="list-style-type: decimal">
<li>
<p>Switching branches:</p>
<div class="inline-figure">
<img src="images/github-branches.png"><!-- -->
</div>
</li>
<li><div class="inline-figure">Clicking <img src="images/pr-create.png"><!-- -->
</div></li>
</ol>
<p>This will create a page that looks like this:</p>
<div class="inline-figure">
<img src="images/pr.png"><!-- -->
</div>
<p>This pull request, which fixes a couple of small problems, is one that was submitted to this book’s GitHub site.</p>
<p>There are three parts to a pull request:</p>
<ul>
<li><p>A <strong>conversation</strong>,
<img src="images/pr-conversation.png"><!-- -->,
where you can discuss the changes as a whole.</p></li>
<li><p>The <strong>commits</strong> view,
<img src="images/pr-commits.png"><!-- -->,
where you can see each individual commit.</p></li>
<li><p>The <strong>file changes</strong>,
<img src="images/pr-changes.png"><!-- -->,
where you see the overall diff of the commits, and you can comment
on individual lines.</p></li>
</ul>
<p>Once you’re done discussing a pull request, you either choose to merge it or delete it. Merging it is equivalent to running <code>git merge &lt;branchname&gt;</code> from the shell; deleting is equivalent to <code>git branch -d &lt;branchname&gt;</code>.</p>
</div>
<div id="pr-make" class="section level2">
<h2>
<span class="header-section-number">18.15</span> Submitting a pull request to another repo<a class="anchor" aria-label="anchor" href="#pr-make"><i class="fas fa-link"></i></a>
</h2>
<p>To submit a pull request to a repo that you don’t own, you first need to create a copy of the repo that you can own, called a <strong>fork</strong>, and then clone that fork on your own computer:</p>
<ol style="list-style-type: decimal">
<li><p><strong>Fork</strong> the original repo by going to the repo on GitHub and clicking
<img src="images/github-fork.png"><!-- -->.
This creates a copy of the repo that belongs to you.</p></li>
<li>
<p><strong>Clone</strong> the forked repo to create a local copy of the remote repo.
It’s possible to do this within RStudio (using “Create New Project” from
“Version Control”) but I think it’s easier to do it from the shell:</p>
<div class="sourceCode" id="cb252"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb252-1"><a href="git.html#cb252-1"></a><span class="fu">git</span> clone git@github.com:<span class="op">&lt;</span>your-name<span class="op">&gt;</span>/<span class="op">&lt;</span>repo<span class="op">&gt;</span>.git</span>
<span id="cb252-2"><a href="git.html#cb252-2"></a><span class="bu">cd</span> <span class="op">&lt;</span>repo<span class="op">&gt;</span></span></code></pre></div>
</li>
</ol>
<p>A fork is a <em>static</em> copy of the repo: once you’ve created it, GitHub does nothing to keep it in sync with the upstream repo. This is a problem because while you’re working on a pull request, changes might occur in the original repo. To keep the forked and the original repo in sync, start by telling your repo about the upstream repo:</p>
<div class="sourceCode" id="cb253"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb253-1"><a href="git.html#cb253-1"></a><span class="fu">git</span> remote add upstream git@github.com:<span class="op">&lt;</span>original-name<span class="op">&gt;</span>/<span class="op">&lt;</span>repo<span class="op">&gt;</span>.git</span>
<span id="cb253-2"><a href="git.html#cb253-2"></a><span class="fu">git</span> fetch upstream</span></code></pre></div>
<p>Then you can merge changes from the upstream repo to your local copy:</p>
<div class="sourceCode" id="cb254"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb254-1"><a href="git.html#cb254-1"></a><span class="fu">git</span> merge upstream/master</span></code></pre></div>
<p>When working on a forked repo, I recommend that you don’t work on the master branch. Because you’re not really working on the main line of development for that repo, using your master branch makes things confusing.</p>
<p>If you always create pull requests in branches, you can make it a little easier to keep your local repo in sync with the upstream repo by running:</p>
<div class="sourceCode" id="cb255"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb255-1"><a href="git.html#cb255-1"></a><span class="fu">git</span> branch -u upstream/master   </span></code></pre></div>
<p>Then you can update your local repo with the following code:</p>
<div class="sourceCode" id="cb256"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb256-1"><a href="git.html#cb256-1"></a><span class="fu">git</span> checkout master</span>
<span id="cb256-2"><a href="git.html#cb256-2"></a><span class="fu">git</span> pull</span></code></pre></div>
<p>Changes may occur while you’re working on the pull request, so remember to merge them into your branch with:</p>
<div class="sourceCode" id="cb257"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb257-1"><a href="git.html#cb257-1"></a><span class="fu">git</span> checkout <span class="op">&lt;</span>my-branch<span class="op">&gt;</span></span>
<span id="cb257-2"><a href="git.html#cb257-2"></a><span class="fu">git</span> merge master</span></code></pre></div>
<p>A pull request (PR) is a one-to-one mapping to a branch, so you can also use this technique to make updates based on the pull request discussion. Don’t create a new pull request each time you make a change; instead you just need to push the branch that the PR is based on and the PR webpage will automatically update.</p>
<p>The diagram below illustrates the main steps of creating a pull request and updating the request as the upstream repo changes:</p>
<div class="inline-figure">
<img src="diagrams/pull-request-process.png"><!-- -->
</div>
</div>
<div id="pr-accept" class="section level2">
<h2>
<span class="header-section-number">18.16</span> Reviewing and accepting pull requests<a class="anchor" aria-label="anchor" href="#pr-accept"><i class="fas fa-link"></i></a>
</h2>
<p>As your package gets more popular, you’re likely to receive pull requests. Receiving a pull request is fantastic. Someone not only cares about your package enough to use it, they’ve actually read the source code and made an improvement!</p>
<p>When you receive a pull request, I recommend reviewing it using the three step approach described by Sarah Sharp. I summarise the three phases below, but I highly recommend reading the full article at <a href="https://sarah.thesharps.us/2014/09/01/the-gentle-art-of-patch-review/" class="uri">https://sarah.thesharps.us/2014/09/01/the-gentle-art-of-patch-review/</a>:</p>
<ol style="list-style-type: decimal">
<li><p>Is it a good idea? If you don’t think the contribution is a good fit for
your project, it’s polite to let the contributor know as quickly as
possible. Thank them for their work, and refocus them on a better area to
work on.</p></li>
<li><p>Is the overall approach sound? At this point you want to focus on the big
picture: have they modified the right functions in the right way? Avoid
nitpicking minor style problems (that’s the final phase); instead just
provide a pointer to your style preferences, e.g. the <em>tidyverse style guide</em>
at <a href="https://style.tidyverse.org/" class="uri">https://style.tidyverse.org/</a>.</p></li>
<li>
<p>Is it polished? In the final review phase, make sure that the non-code
parts of the PR are polished. Prompt the contributor to update the
documentation, point out spelling mistakes and suggest better wording.</p>
<p>I recommend asking the contributor to include a bullet point in <code>NEWS.md</code>,
briefly describing the improvement and thanking themselves with their GitHub
username. More details to follow in <a href="release.html#post-release">post release</a>).</p>
</li>
</ol>
<p>After discussion is complete, you can incorporate the changes by clicking the merge button. If the button doesn’t work, GitHub provides some instructions on how to do it from the command line. While you’ve seen all the pieces before, it’s useful to read through this just so you understand what exactly is happening.</p>
<div class="sourceCode" id="cb258"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb258-1"><a href="git.html#cb258-1"></a><span class="co"># Create a new branch, and sync it with the pull request</span></span>
<span id="cb258-2"><a href="git.html#cb258-2"></a><span class="fu">git</span> checkout -b <span class="op">&lt;</span>branch<span class="op">&gt;</span> master</span>
<span id="cb258-3"><a href="git.html#cb258-3"></a><span class="fu">git</span> pull https://github.com/<span class="op">&lt;</span>user<span class="op">&gt;</span>/<span class="op">&lt;</span>branch<span class="op">&gt;</span>.git patch-3</span>
<span id="cb258-4"><a href="git.html#cb258-4"></a></span>
<span id="cb258-5"><a href="git.html#cb258-5"></a><span class="co"># Merge the changes into the main line of development</span></span>
<span id="cb258-6"><a href="git.html#cb258-6"></a><span class="fu">git</span> checkout master</span>
<span id="cb258-7"><a href="git.html#cb258-7"></a><span class="fu">git</span> merge --no-ff <span class="op">&lt;</span>branch<span class="op">&gt;</span></span>
<span id="cb258-8"><a href="git.html#cb258-8"></a><span class="co"># Resolve conflicts, stage and add.</span></span>
<span id="cb258-9"><a href="git.html#cb258-9"></a></span>
<span id="cb258-10"><a href="git.html#cb258-10"></a><span class="co"># Sync your local changes with GitHub</span></span>
<span id="cb258-11"><a href="git.html#cb258-11"></a><span class="fu">git</span> push origin master</span></code></pre></div>
</div>
<div id="git-learning" class="section level2">
<h2>
<span class="header-section-number">18.17</span> Learning more<a class="anchor" aria-label="anchor" href="#git-learning"><i class="fas fa-link"></i></a>
</h2>
<p>Git and GitHub are a rich and powerful set of tools, and there’s no way this chapter has taught you everything you need to know. However, you should now have the basic knowledge to be effective, and you should be in a good position to learn more. Some good resources are:</p>
<ul>
<li><p>GitHub help, <a href="https://help.github.com" class="uri">https://help.github.com</a>, not only teaches you about
GitHub, but also has good tutorials on many Git features.</p></li>
<li><p>If you’d like to learn more about the details of Git, read
<a href="https://git-scm.com/book/en/v2">Pro Git</a> by Scott Chacon and Ben Straub.</p></li>
</ul>
<p>Finally, StackOverflow is a vital part of Git - when you have a problem that you don’t know how to solve, StackOverflow should be your first resource. It’s highly likely that someone has already had the same exact problem as you, and that there will be a variety of approaches and solutions to choose from.</p>

</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="misc.html"><span class="header-section-number">17</span> Other components</a></div>
<div class="next"><a href="r-cmd-check.html"><span class="header-section-number">19</span> Automated checking</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#git"><span class="header-section-number">18</span> Git and GitHub</a></li>
<li><a class="nav-link" href="#git-rstudio"><span class="header-section-number">18.1</span> RStudio, Git and GitHub</a></li>
<li><a class="nav-link" href="#git-setup"><span class="header-section-number">18.2</span> Initial set up</a></li>
<li><a class="nav-link" href="#git-init"><span class="header-section-number">18.3</span> Create a local Git repository</a></li>
<li><a class="nav-link" href="#git-status"><span class="header-section-number">18.4</span> See what’s changed</a></li>
<li><a class="nav-link" href="#git-commit"><span class="header-section-number">18.5</span> Record changes</a></li>
<li><a class="nav-link" href="#commit-best-practices"><span class="header-section-number">18.6</span> Commit best practices</a></li>
<li><a class="nav-link" href="#git-ignore"><span class="header-section-number">18.7</span> Ignoring files</a></li>
<li><a class="nav-link" href="#git-undo"><span class="header-section-number">18.8</span> Undo a mistake</a></li>
<li><a class="nav-link" href="#github-init"><span class="header-section-number">18.9</span> Synchronising with GitHub</a></li>
<li><a class="nav-link" href="#github-benefit"><span class="header-section-number">18.10</span> Benefits of using GitHub</a></li>
<li><a class="nav-link" href="#git-pull"><span class="header-section-number">18.11</span> Working with others</a></li>
<li><a class="nav-link" href="#github-issues"><span class="header-section-number">18.12</span> Issues</a></li>
<li><a class="nav-link" href="#git-branch"><span class="header-section-number">18.13</span> Branches</a></li>
<li><a class="nav-link" href="#git-pullreq"><span class="header-section-number">18.14</span> Making a pull request</a></li>
<li><a class="nav-link" href="#pr-make"><span class="header-section-number">18.15</span> Submitting a pull request to another repo</a></li>
<li><a class="nav-link" href="#pr-accept"><span class="header-section-number">18.16</span> Reviewing and accepting pull requests</a></li>
<li><a class="nav-link" href="#git-learning"><span class="header-section-number">18.17</span> Learning more</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/hadley/r-pkgs/blob/main/git.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/hadley/r-pkgs/edit/main/git.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>R Packages</strong>" was written by Hadley Wickham, Jennifer Bryan. </p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer>
</body>
</html>
