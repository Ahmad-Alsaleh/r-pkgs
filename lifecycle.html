<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.313">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="description" content="Learn how to create a package, the fundamental unit of shareable, reusable, and reproducible R code.">
<title>R Packages (2e) - 22&nbsp; Lifecycle</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./references.html" rel="next">
<link href="./software-development-practices.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script><script defer="" data-domain="r-pkgs.org" src="https://plausible.io/js/plausible.js"></script>
</head>
<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }"><div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Lifecycle</span></h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">R Packages (2e)</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/hadley/r-pkgs/" title="Source Code" class="sidebar-tool px-1"><i class="bi bi-github"></i></a>
  <a href="" class="quarto-reader-toggle sidebar-tool" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">Welcome!</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./preface.html" class="sidebar-item-text sidebar-link">Preface</a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">Getting started</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./introduction.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./whole-game.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">The Whole Game</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./setup.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">System setup</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./structure.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Package structure and state</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./workflow101.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Fundamental development workflows</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./package-within.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">The package within</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">Package components</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./code.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">R code</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./misc.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Other components</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">Package metadata</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./description.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title"><code>DESCRIPTION</code></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./dependencies-mindset-background.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Dependencies: Mindset and Background</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./dependencies-in-practice.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Dependencies: In Practice</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./license.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Licensing</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">Testing</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./testing-basics.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Testing basics</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./testing-design.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Designing your test suite</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./testing-advanced.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Advanced testing techniques</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">Documentation</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./man.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Function documentation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./vignettes.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Vignettes</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./other-markdown.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Other markdown files</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./website.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Website</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true">Maintenance and distribution</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./software-development-practices.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Software development practices</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lifecycle.html" class="sidebar-item-text sidebar-link active"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Lifecycle</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">References</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="true">Appendices</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./R-CMD-check.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title"><code>R CMD check</code></span></a>
  </div>
</li>
      </ul>
</li>
    </ul>
</div>
</nav><!-- margin-sidebar --><div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Table of contents</h2>
   
  <ul>
<li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction"><span class="toc-section-number">22.1</span>  Introduction</a></li>
  <li><a href="#package-evolution" id="toc-package-evolution" class="nav-link" data-scroll-target="#package-evolution"><span class="toc-section-number">22.2</span>  Package evolution</a></li>
  <li><a href="#sec-lifecycle-version-number" id="toc-sec-lifecycle-version-number" class="nav-link" data-scroll-target="#sec-lifecycle-version-number"><span class="toc-section-number">22.3</span>  Package version number</a></li>
  <li><a href="#tidyverse-package-version-conventions" id="toc-tidyverse-package-version-conventions" class="nav-link" data-scroll-target="#tidyverse-package-version-conventions"><span class="toc-section-number">22.4</span>  Tidyverse package version conventions</a></li>
  <li>
<a href="#major-vs.-minor-vs.-patch-release" id="toc-major-vs.-minor-vs.-patch-release" class="nav-link" data-scroll-target="#major-vs.-minor-vs.-patch-release"><span class="toc-section-number">22.5</span>  Major vs.&nbsp;minor vs.&nbsp;patch release</a>
  <ul class="collapse">
<li><a href="#package-version-mechanics" id="toc-package-version-mechanics" class="nav-link" data-scroll-target="#package-version-mechanics"><span class="toc-section-number">22.5.1</span>  Package version mechanics</a></li>
  </ul>
</li>
  <li><a href="#sec-lifecycle-backward-compatibility" id="toc-sec-lifecycle-backward-compatibility" class="nav-link" data-scroll-target="#sec-lifecycle-backward-compatibility"><span class="toc-section-number">22.6</span>  Backward compatibility</a></li>
  <li>
<a href="#lifecycle-stages-and-tools-and-package" id="toc-lifecycle-stages-and-tools-and-package" class="nav-link" data-scroll-target="#lifecycle-stages-and-tools-and-package"><span class="toc-section-number">22.7</span>  Lifecycle stages and tools and package</a>
  <ul class="collapse">
<li><a href="#lifecycle-stages-and-badges" id="toc-lifecycle-stages-and-badges" class="nav-link" data-scroll-target="#lifecycle-stages-and-badges"><span class="toc-section-number">22.7.1</span>  Lifecycle stages and badges</a></li>
  <li><a href="#deprecating-a-function-or-argument" id="toc-deprecating-a-function-or-argument" class="nav-link" data-scroll-target="#deprecating-a-function-or-argument"><span class="toc-section-number">22.7.2</span>  Deprecating a function or argument</a></li>
  </ul>
</li>
  <li>
<a href="#sec-release" id="toc-sec-release" class="nav-link" data-scroll-target="#sec-release"><span class="toc-section-number">22.8</span>  Releasing to CRAN</a>
  <ul class="collapse">
<li><a href="#sec-release-process" id="toc-sec-release-process" class="nav-link" data-scroll-target="#sec-release-process"><span class="toc-section-number">22.8.1</span>  The submission process</a></li>
  <li><a href="#release-test-env" id="toc-release-test-env" class="nav-link" data-scroll-target="#release-test-env"><span class="toc-section-number">22.8.2</span>  Test environments</a></li>
  <li><a href="#sec-cran-flavors-services" id="toc-sec-cran-flavors-services" class="nav-link" data-scroll-target="#sec-cran-flavors-services"><span class="toc-section-number">22.8.3</span>  CRAN check flavors and related services</a></li>
  <li><a href="#release-check" id="toc-release-check" class="nav-link" data-scroll-target="#release-check"><span class="toc-section-number">22.8.4</span>  Check results</a></li>
  <li><a href="#release-deps" id="toc-release-deps" class="nav-link" data-scroll-target="#release-deps"><span class="toc-section-number">22.8.5</span>  Reverse dependencies</a></li>
  <li><a href="#cran-policies" id="toc-cran-policies" class="nav-link" data-scroll-target="#cran-policies"><span class="toc-section-number">22.8.6</span>  CRAN policies</a></li>
  <li><a href="#sec-release-submission" id="toc-sec-release-submission" class="nav-link" data-scroll-target="#sec-release-submission"><span class="toc-section-number">22.8.7</span>  Release</a></li>
  <li><a href="#on-failure" id="toc-on-failure" class="nav-link" data-scroll-target="#on-failure"><span class="toc-section-number">22.8.8</span>  On failure</a></li>
  <li><a href="#binary-builds" id="toc-binary-builds" class="nav-link" data-scroll-target="#binary-builds"><span class="toc-section-number">22.8.9</span>  Binary builds</a></li>
  <li><a href="#post-release" id="toc-post-release" class="nav-link" data-scroll-target="#post-release"><span class="toc-section-number">22.8.10</span>  Prepare for next version</a></li>
  <li><a href="#promotion" id="toc-promotion" class="nav-link" data-scroll-target="#promotion"><span class="toc-section-number">22.8.11</span>  Publicising your package</a></li>
  <li><a href="#congratulations" id="toc-congratulations" class="nav-link" data-scroll-target="#congratulations"><span class="toc-section-number">22.8.12</span>  Congratulations!</a></li>
  </ul>
</li>
  </ul><div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/hadley/r-pkgs/edit/main/lifecycle.Rmd" class="toc-action">Edit this page</a></p><p><a href="https://github.com/hadley/r-pkgs/issues/new" class="toc-action">Report an issue</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<h1 class="title"><span id="sec-lifecycle" class="quarto-section-identifier d-none d-lg-block"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Lifecycle</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header><div class="cell">
<div class="cell-output-display">
<div class="callout-warning callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Second edition
</div>
</div>
<div class="callout-body-container callout-body">
<p>You are reading the work-in-progress second edition of R Packages. This chapter is currently a dumping ground for ideas, and we don’t recommend reading it.</p>
</div>
</div>
</div>
</div>
<section id="introduction" class="level2" data-number="22.1"><h2 data-number="22.1" class="anchored" data-anchor-id="introduction">
<span class="header-section-number">22.1</span> Introduction</h2>
<p>The closing chapter of the book is about managing the evolution of your package and, perhaps eventually, distributing it through CRAN.</p>
<p>The trickiest part of managing change is balancing the interests of various stakeholders:</p>
<ul>
<li><p>The maintainer(s), which includes you and possibly others (especially in the future).</p></li>
<li><p>The existing users, which could be just you or a small group of colleagues or it could be tens of thousands of people.</p></li>
<li><p>The future users, which hopefully includes the existing users, but could potentially include many more people.</p></li>
</ul>
<p>It’s impossible to optimize for all of these folks, all of the time, all at once. So we’ll describe how we think about various trade-offs. Even if your priorities differ from ours, this chapter should still help you identify issues you want to consider.</p>
<p>It’s helpful to have a framework for talking about the different phases a package or a function goes through, such as “experimental” or “stable”. In ?? we present the lifecycle stages used by tidyverse packages. We can then connect transitions between these stages to concrete and specific actions, like incrementing the package version number and using messages or warnings to influence how people use your package.</p>
<p>Finally, in ?? we delve into the specifics of releasing a package on CRAN and the ongoing work required to keep it safely on CRAN. We’ve been calling out CRAN-specific concerns throughout the book. So ?? is where we underscore some of the most crucial points and, most importantly, can take a holistic look at blah blah CRAN.</p>
</section><section id="package-evolution" class="level2" data-number="22.2"><h2 data-number="22.2" class="anchored" data-anchor-id="package-evolution">
<span class="header-section-number">22.2</span> Package evolution</h2>
<p>First we should establish a working definition of what it means for your package to change. Technically, you could say that the package has changed every time any file in its source changes. This level of pedantry isn’t terribly useful, though. The smallest increment of change that’s meaningful is probably a Git commit. This represents a specific state of the source package that can be talked about, installed from, compared to, subjected to <code>R CMD check</code>, reverted to, and so on. This level of granularity is really only of interest to developers. But the package states accessible via the Git history are genuinely useful for the maintainer, so if you needed any encouragement to be more intentional with your commits, let this be it.</p>
<p>The primary user-facing signal of meaningful change is the package version number. Recall that this important piece of metadata lives in the <code>Version</code> field of the <code>DESCRIPTION</code> file:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode yaml code-with-copy"><code class="sourceCode yaml"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Package</span><span class="kw">:</span><span class="at"> usethis</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">Title</span><span class="kw">:</span><span class="at"> Automate Package and Project Setup</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">Version</span><span class="kw">:</span><span class="at"> </span><span class="fl">2.1.6</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co">...</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>If you visit the CRAN landing page for usethis, you can access its history via <em>Downloads &gt; Old sources &gt; <a href="https://cran.r-project.org/src/contrib/Archive/usethis/">usethis archive</a></em>. That links to a folder of package bundles (<a href="structure.html#sec-bundled-package"><span>Section&nbsp;4.4</span></a>), reflecting usethis’s source for each version released on CRAN:</p>
<div class="cell" data-r.options="{&quot;tidyverse.quiet&quot;:true}">
<div class="cell-output-display">
<table class="table table-sm table-striped">
<thead><tr class="header">
<th style="text-align: left;">Version</th>
<th style="text-align: left;">Date</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">1.0.0</td>
<td style="text-align: left;">2017-10-22 17:36:29 UTC</td>
</tr>
<tr class="even">
<td style="text-align: left;">1.1.0</td>
<td style="text-align: left;">2017-11-17 22:52:07 UTC</td>
</tr>
<tr class="odd">
<td style="text-align: left;">1.2.0</td>
<td style="text-align: left;">2018-01-19 18:23:54 UTC</td>
</tr>
<tr class="even">
<td style="text-align: left;">1.3.0</td>
<td style="text-align: left;">2018-02-24 21:53:51 UTC</td>
</tr>
<tr class="odd">
<td style="text-align: left;">1.4.0</td>
<td style="text-align: left;">2018-08-14 12:10:02 UTC</td>
</tr>
<tr class="even">
<td style="text-align: left;">1.5.0</td>
<td style="text-align: left;">2019-04-07 10:50:44 UTC</td>
</tr>
<tr class="odd">
<td style="text-align: left;">1.5.1</td>
<td style="text-align: left;">2019-07-04 11:00:05 UTC</td>
</tr>
<tr class="even">
<td style="text-align: left;">1.6.0</td>
<td style="text-align: left;">2020-04-09 04:50:02 UTC</td>
</tr>
<tr class="odd">
<td style="text-align: left;">1.6.1</td>
<td style="text-align: left;">2020-04-29 05:50:02 UTC</td>
</tr>
<tr class="even">
<td style="text-align: left;">1.6.3</td>
<td style="text-align: left;">2020-09-17 17:00:03 UTC</td>
</tr>
<tr class="odd">
<td style="text-align: left;">2.0.0</td>
<td style="text-align: left;">2020-12-10 09:00:02 UTC</td>
</tr>
<tr class="even">
<td style="text-align: left;">2.0.1</td>
<td style="text-align: left;">2021-02-10 10:40:06 UTC</td>
</tr>
<tr class="odd">
<td style="text-align: left;">2.1.0</td>
<td style="text-align: left;">2021-10-16 23:30:02 UTC</td>
</tr>
<tr class="even">
<td style="text-align: left;">2.1.2</td>
<td style="text-align: left;">2021-10-25 07:30:02 UTC</td>
</tr>
<tr class="odd">
<td style="text-align: left;">2.1.3</td>
<td style="text-align: left;">2021-10-27 15:00:02 UTC</td>
</tr>
<tr class="even">
<td style="text-align: left;">2.1.5</td>
<td style="text-align: left;">2021-12-09 23:00:02 UTC</td>
</tr>
<tr class="odd">
<td style="text-align: left;">2.1.6</td>
<td style="text-align: left;">2022-05-25 20:50:02 UTC</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>This is the type of package evolution we’re going to address in this chapter. In section <a href="#sec-lifecycle-version-number"><span>Section&nbsp;22.3</span></a>, we’ll delve into the world of software version numbers, which is a richer topic than you might expect. R also has some specific rules and tools around package version numbers. Finally, we’ll explain the conventions we use for the version numbers of tidyverse packages.</p>
<p>But first, this is a good time to revisit a resource we first pointed out in <a href="structure.html#sec-source-package"><span>Section&nbsp;4.3</span></a>, when introducing the different states of an R package. Recall that the (unofficial) <code>cran</code> organization on GitHub provides a read-only history of all CRAN packages. For example, you can get a different view of usethis’s released versions at <a href="https://github.com/cran/usethis/" class="uri">https://github.com/cran/usethis/</a>.</p>
<p>The archive provided by CRAN itself allows you to download older versions of usethis as <code>.tar.gz</code> files, which is useful if you truly want to get your hands on the source of an older version. However, if you just want to quickly check something about a version or compare two versions of usethis, the read-only GitHub mirror is much more useful. Each commit in this repo’s history represents a CRAN release, which makes it easy to see exactly what changed: <a href="https://github.com/cran/usethis/commits/HEAD" class="uri">https://github.com/cran/usethis/commits/HEAD</a>. Furthermore, you can browse the state of all the package’s source files at any specific version, such as <a href="https://github.com/cran/usethis/tree/1.0.0">usethis’s initial release at version 1.0.0</a><a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a>.</p>
<p>This information is technically available from the repository where usethis is actually developed (<a href="https://github.com/r-lib/usethis" class="uri">https://github.com/r-lib/usethis</a>). But you have to work much harder to zoom out to the level of CRAN releases, amid the clutter of the small incremental steps in which development actually unfolds. These three different views of usethis’s evolution are all useful for different purposes:</p>
<ul>
<li><p><a href="https://cran.r-project.org/src/contrib/Archive/usethis/" class="uri">https://cran.r-project.org/src/contrib/Archive/usethis/</a></p></li>
<li><p><a href="https://github.com/cran/usethis/commits/HEAD" class="uri">https://github.com/cran/usethis/commits/HEAD</a></p></li>
<li><p><a href="https://github.com/r-lib/usethis/commits/HEAD" class="uri">https://github.com/r-lib/usethis/commits/HEAD</a></p></li>
</ul></section><section id="sec-lifecycle-version-number" class="level2" data-number="22.3"><h2 data-number="22.3" class="anchored" data-anchor-id="sec-lifecycle-version-number">
<span class="header-section-number">22.3</span> Package version number</h2>
<p>Formally, an R package version is a sequence of at least two integers separated by either <code>.</code> or <code>-</code>. For example, <code>1.0</code> and <code>0.9.1-10</code> are valid versions, but <code>1</code> and <code>1.0-devel</code> are not. Base R offers the <code>utils::package_version()</code><a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a> function to parse a package version string into a proper S3 class by the same name. This class makes it easier to do things like compare versions.</p>
<div class="cell">
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/numeric_version.html">package_version</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"1.0"</span>, <span class="st">"0.9.1-10"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] '1.0'      '0.9.1.10'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric_version.html">package_version</a></span><span class="op">(</span><span class="st">"1.0"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "package_version" "numeric_version"</span></span>
<span></span>
<span><span class="co"># these versions are not allowed for an R package</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/numeric_version.html">package_version</a></span><span class="op">(</span><span class="st">"1"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Error: invalid version specification '1'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/numeric_version.html">package_version</a></span><span class="op">(</span><span class="st">"1.0-devel"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Error: invalid version specification '1.0-devel'</span></span>
<span></span>
<span><span class="co"># comparing package versions</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/numeric_version.html">package_version</a></span><span class="op">(</span><span class="st">"1.9"</span><span class="op">)</span> <span class="op">==</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric_version.html">package_version</a></span><span class="op">(</span><span class="st">"1.9.0"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/numeric_version.html">package_version</a></span><span class="op">(</span><span class="st">"1.9"</span><span class="op">)</span> <span class="op">&lt;</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric_version.html">package_version</a></span><span class="op">(</span><span class="st">"1.9.2"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/numeric_version.html">package_version</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"1.9"</span>, <span class="st">"1.9.2"</span><span class="op">)</span><span class="op">)</span> <span class="op">&lt;</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric_version.html">package_version</a></span><span class="op">(</span><span class="st">"1.10"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE TRUE</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The last examples above make it clear that R considers version <code>1.9</code> to be equal to <code>1.9.0</code> and to be less than <code>1.9.2</code>. And both <code>1.9</code> and <code>1.9.2</code> are less than <code>1.10</code>, which you should think of as version “one point ten”, not “one point one zero”.</p>
<p>If you’re skeptical that the <code>package_version</code> class is really necessary, check out this example:</p>
<div class="cell">
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="st">"2.0"</span> <span class="op">&gt;</span> <span class="st">"10.0"</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/numeric_version.html">package_version</a></span><span class="op">(</span><span class="st">"2.0"</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric_version.html">package_version</a></span><span class="op">(</span><span class="st">"10.0"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] FALSE</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The string <code>2.0</code> is considered to be greater than the string <code>10.0</code>, because the character <code>2</code> comes after the character <code>1</code>. By parsing version strings into proper <code>package_version</code> objects, we get the correct comparison, i.e.&nbsp;that version <code>2.0</code> is less than version <code>10.0</code>.</p>
<p>R offers this support for working with package versions, because it’s necessary, for example, to determine whether package dependencies are satisfied (<a href="description.html#sec-description-imports-suggests-minium-version"><span>Section&nbsp;10.7.1</span></a>). Under-the-hood, this tooling is used to enforce minimum versions recorded like this in <code>DESCRIPTION</code>:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode yaml code-with-copy"><code class="sourceCode yaml"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Imports</span><span class="kw">:</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="at">    dplyr (&gt;= 1.0.0),</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="at">    tidyr (&gt;= 1.1.0)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>In your own code, if you need to determine which version of a package is installed, use <code><a href="https://rdrr.io/r/utils/packageDescription.html">utils::packageVersion()</a></code><a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a>:</p>
<div class="cell">
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/packageDescription.html">packageVersion</a></span><span class="op">(</span><span class="st">"usethis"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] '2.1.6'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/packageDescription.html">packageVersion</a></span><span class="op">(</span><span class="st">"usethis"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Classes 'package_version', 'numeric_version'  hidden list of 1</span></span>
<span><span class="co">#&gt;  $ : int [1:3] 2 1 6</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/packageDescription.html">packageVersion</a></span><span class="op">(</span><span class="st">"usethis"</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric_version.html">package_version</a></span><span class="op">(</span><span class="st">"10.0"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] FALSE</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/packageDescription.html">packageVersion</a></span><span class="op">(</span><span class="st">"usethis"</span><span class="op">)</span> <span class="op">&gt;</span> <span class="st">"10.0"</span></span>
<span><span class="co">#&gt; [1] FALSE</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The return value of <code><a href="https://rdrr.io/r/utils/packageDescription.html">packageVersion()</a></code> has the <code>package_version</code> class and is therefore ready for comparison to other version numbers. Note the last example where we seem to be comparing a version number to a string. How can we get the correct result without explicitly converting <code>10.0</code> to a package version? It turns out this conversion is automatic as long as one of the comparators has the <code>package_version</code> class.</p>
</section><section id="tidyverse-package-version-conventions" class="level2" data-number="22.4"><h2 data-number="22.4" class="anchored" data-anchor-id="tidyverse-package-version-conventions">
<span class="header-section-number">22.4</span> Tidyverse package version conventions</h2>
<p>R considers <code>0.9.1-10</code> to be a valid package version, but you’ll never see a version number like that for a tidyverse package. Here is our recommended framework for managing the package version number:</p>
<ul>
<li><p>Always use <code>.</code> as the separator, never <code>-</code>.</p></li>
<li><p>A released version number consists of three numbers, <code>&lt;major&gt;.&lt;minor&gt;.&lt;patch&gt;</code>. For version number <code>1.9.2</code>, <code>1</code> is the major number, <code>9</code> is the minor number, and <code>2</code> is the patch number. Never use versions like <code>1.0</code>. Always spell out the three components, <code>1.0.0</code>.</p></li>
<li>
<p>An in-development package has a fourth component: the development version. This should start at 9000. The number 9000 is arbitrary, but provides a clear signal that there’s something different about this version number. There are two reasons for this practice: First, the presence of a fourth component makes it easy to tell if you’re dealing with a released or in-development version. Also, the use of the fourth place means that you’re not limited to what the next released version will be. <code>0.0.1</code>, <code>0.1.0</code>, and <code>1.0.0</code> are all greater than <code>0.0.0.9000</code>.</p>
<p>Increment the development version, e.g.&nbsp;from <code>9000</code> to <code>9001</code>, if you’ve added an important feature and you (or others) need to be able to detect or require the presence of this feature. For example, this can happen when two packages are developing in tandem. This is generally the only reason that we bother to increment the development version. This makes in-development versions special and, in some sense, degenerate. Since we don’t increment the development component with each Git commit, the same package version number is associated with many different states of the package source, in between releases.</p>
</li>
</ul>
<p>The advice above is inspired in part by <a href="https://semver.org">Semantic Versioning</a> and by the <a href="https://www.x.org/releases/X11R7.7/doc/xorg-docs/Versions.html">X.Org</a> versioning schemes. Read them if you’d like to understand more about the standards of versioning used by many open source projects. But we should underscore that our practices our inspired by these schemes and are somewhat less regimented. Finally, know that other maintainers follow different philosophies on how to manage the package version number.</p>
</section><section id="major-vs.-minor-vs.-patch-release" class="level2" data-number="22.5"><h2 data-number="22.5" class="anchored" data-anchor-id="major-vs.-minor-vs.-patch-release">
<span class="header-section-number">22.5</span> Major vs.&nbsp;minor vs.&nbsp;patch release</h2>
<p>The version number of your package is always increasing, but it’s more than just an incrementing counter – the way the number changes with each release can convey information about the nature of the changes. The transition from 0.3.1 to 0.3.2, which is a patch release, has a very different vibe from the transition from 0.3.2 to 1.0.0, which is a major release. A package version number can also convey information about where the package is in its lifecycle. For example, the version 1.0.0 often signals that the public interface of a package is considered stable.</p>
<p>How do you decide which type of release to make, i.e.&nbsp;which component(s) of the version should you increment? A key concept is whether the associated changes are backward compatible, meaning that pre-existing code will still “work” with the new version. We put “work” in quotes, because this designation is open to a certain amount of interpretation. A hardliner might take this to mean “the code works in exactly the same way, in all contexts, for all inputs”. A more pragmatic interpretation is that “the code still works, but could produce a different result in some edge cases”. A change that is not backward compatible is often described as a <em>breaking</em> change. In section <a href="#sec-lifecycle-backward-compatibility"><span>Section&nbsp;22.6</span></a>, we’ll revisit the topic of backward compatibility. Similar to the issue of package dependencies (<a href="dependencies-mindset-background.html#sec-dependencies-pros-cons"><span>Section&nbsp;11.2</span></a>), it’s a question of trade-offs.</p>
<p>In practice, backward compatibility is not a clear-cut distinction. It is typical to assess the impact of a change from a few angles:</p>
<ul>
<li><p>Degree of change in behaviour. The most extreme is to make something that used to be possible into an error, i.e.&nbsp;impossible. In contrast, changes to a print method are much less significant.</p></li>
<li><p>How the changes fit into the design of the package. A change to low-level infrastructure, such as a utility that gets called in all user-facing functions, is more fraught than a change that only affects one parameter of a single function.</p></li>
<li><p>How much existing usage is affected. This is a combination of how many of your users will perceive the change and how many existing users there are to begin with.</p></li>
</ul>
<p>Recall that a version number will have one of these forms, if you’re following our conventions:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode default code-with-copy"><code class="sourceCode default"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>&lt;major&gt;.&lt;minor&gt;.&lt;patch&gt;        # released version</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>&lt;major&gt;.&lt;minor&gt;.&lt;patch&gt;.&lt;dev&gt;  # in-development version</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>If the current package version is <code>0.8.1.9000</code>, here’s our advice on how to pick the version number for the next release:</p>
<ul>
<li><p>Increment <code>patch</code>, e.g.&nbsp;<code>0.8.2</code> for a <strong>patch release</strong>: you’ve fixed bugs, but you haven’t added any significant new features. For example, if we discover a show-stopping bug shortly after a release, we would make a quick patch release with the fix. Most releases will have a patch number of 0.</p></li>
<li><p>Increment <code>minor</code>, e.g.&nbsp;<code>0.9.0</code>, for a <strong>minor release</strong>. A minor release can include bug fixes, new features, and changes that are backward compatible<a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a>. This is the most common type of release. It’s perfectly fine to have so many minor releases that you need to use two (or even three!) digits, e.g.&nbsp;<code>1.17.0</code>.</p></li>
<li><p>Increment <code>major</code>, e.g.&nbsp;<code>1.0.0</code>, for a <strong>major release</strong>. This is best reserved for changes that are not backward compatible and that are likely to affect many users. The <code>1.0.0</code> release has special significance and typically indicates that your package is feature complete with a stable API.</p></li>
</ul>
<p>The trickiest decision you are likely to face is whether a change is “breaking” enough to deserve a major release. For example, if you make an API-incompatible change to a rarely-used part of your code, it may not make sense to increase the major number. But if you fix a bug that many people depend on (it happens!), it will feel like a breaking change to those folks. It’s conceivable that such a bug fix could merit a major release.</p>
<section id="package-version-mechanics" class="level3" data-number="22.5.1"><h3 data-number="22.5.1" class="anchored" data-anchor-id="package-version-mechanics">
<span class="header-section-number">22.5.1</span> Package version mechanics</h3>
<p>Your package should start with version number <code>0.0.0.9000</code>. <code><a href="https://usethis.r-lib.org/reference/create_package.html">usethis::create_package()</a></code> starts with this version, by default.</p>
<p>From that point on, you can use <code><a href="https://usethis.r-lib.org/reference/use_version.html">usethis::use_version()</a></code> to increment the package version. When called interactively, with no argument, it presents a helpful menu:</p>
<div class="cell">
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">usethis</span><span class="fu">::</span><span class="fu"><a href="https://usethis.r-lib.org/reference/use_version.html">use_version</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Current version is 0.1.</span></span>
<span><span class="co">#&gt; What should the new version be? (0 to exit) </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; 1: major --&gt; 1.0</span></span>
<span><span class="co">#&gt; 2: minor --&gt; 0.2</span></span>
<span><span class="co">#&gt; 3: patch --&gt; 0.1.1</span></span>
<span><span class="co">#&gt; 4:   dev --&gt; 0.1.0.9000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Selection: </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section></section><section id="sec-lifecycle-backward-compatibility" class="level2" data-number="22.6"><h2 data-number="22.6" class="anchored" data-anchor-id="sec-lifecycle-backward-compatibility">
<span class="header-section-number">22.6</span> Backward compatibility</h2>
<p>The big difference between major and minor releases is whether or not the code is backward compatible. This difference is a bit academic in the R community, because of the way most users manage package installation. If we’re being honest, most R users don’t manage package versions in a very intentional way. Given the way <code><a href="https://rdrr.io/r/utils/update.packages.html">update.packages()</a></code> and <code><a href="https://rdrr.io/r/utils/install.packages.html">install.packages()</a></code> work, it’s quite easy to upgrade a package to a new major version without really meaning to, especially for dependencies of the target package. This, in turn, can lead to unexpected exposure to breaking changes in code that previously worked. This unpleasantness has implications both for users and for maintainers.</p>
<p>If it’s important to protect a data product against change in its R package dependencies, we recommend the use of a project-specific package library. In particular, we like to implement this approach using the <a href="https://rstudio.github.io/renv/">renv package</a>. This supports a lifestyle where a user’s default package library is managed in the usual, somewhat haphazard way. But any project that has a specific, higher requirement for reproducibility is managed with renv. This keeps package updates triggered by work in project A from breaking the code in project B and also helps with collaboration and deployment.</p>
<p>We suspect that package-specific libraries and tools like renv are currently under-utilized in the R world. That is, lots of R users still use just one package library. Therefore, package maintainers still need to exercise considerable caution and care when they introduce breaking changes, regardless of what’s happening with the version number. In section ??, we describe how tidyverse packages approach this, supported by tools in the lifecycle package.</p>
<p>As with dependencies (<a href="dependencies-mindset-background.html#sec-dependencies-pros-cons"><span>Section&nbsp;11.2</span></a>), we find that extremism isn’t a very productive stance. Extreme resistance to breaking change puts a significant drag on ongoing development and maintenance. Backward compatible code tends to be harder to work with because of the need to maintain multiple paths to support functionality from previous versions. The harder you strive to maintain backward compatibility, the harder it is to develop new features or fix old mistakes. This, in turn, can discourage adoption by new users and can make it harder to recruit new contributors. Be concerned about backward compatibility, but don’t let it paralyze you.</p>
<p>The importance of backward compatibility is directly proportional to the number of people using your package: you are trading your time and pain for that of your users. There are good reasons to make backward incompatible changes. Once you’ve decided it’s necessary, your main priority is to use a humane process that is respectful of your users.</p>
</section><section id="lifecycle-stages-and-tools-and-package" class="level2" data-number="22.7"><h2 data-number="22.7" class="anchored" data-anchor-id="lifecycle-stages-and-tools-and-package">
<span class="header-section-number">22.7</span> Lifecycle stages and tools and package</h2>
<p><em>obviously the name of this section need to change</em></p>
<p>The tidyverse team’s approach to package evolution has become more structured and deliberate over the years. The system relies on two major components:</p>
<ul>
<li><p>Lifecycle stages, which can be applied at different levels, i.e.&nbsp;to an individual argument or function or to an entire package.</p></li>
<li><p>Deprecation tools and conventions, which we use when transitioning a function from one lifecycle stage to another.</p></li>
</ul>
<p>The lifecycle package is the primary home for these tools and its documentation is a great place to learn more (<a href="https://lifecycle.r-lib.org/index.html">lifecycle.r-lib.org</a>). We won’t duplicate too much of those details here. Instead, we highlight the general principles of lifecycle management and present some specific examples of successful lifecycle “moves”.</p>
<section id="lifecycle-stages-and-badges" class="level3" data-number="22.7.1"><h3 data-number="22.7.1" class="anchored" data-anchor-id="lifecycle-stages-and-badges">
<span class="header-section-number">22.7.1</span> Lifecycle stages and badges</h3>
<p>The four lifecycle stages are:</p>
<ul>
<li><p>Stable. This is the default stage and signals that users should feel comfortable relying on a function or package. Breaking changes should be rare and should happen gradually, giving users sufficient time and guidance to adapt their usage.</p></li>
<li><p>Experimental. This is appropriate when a function is first introduced and the maintainer reserves the right to change it without much of a deprecation process.</p></li>
<li><p>Deprecated. This applies to functionality that is slated for removal. Initially, it still works, but triggers a deprecation warning with information about preferred alternatives. After a suitable amount of time and with an appropriate version change, such functions are typically removed.</p></li>
<li><p>Superseded. This is a softer version of deprecated, where legacy functionality is preserved as if in a time capsule. Superseded functions receive only minimal maintenance, such as critical bug fixes.</p></li>
</ul>
<p>You can get much more detail in <code><a href="https://lifecycle.r-lib.org/articles/stages.html">vignette("stages", package = "lifecycle")</a></code>.</p>
<p>The lifecycle stage is most often communicated through a badge. If you’d like to use lifecycle badges, call <code><a href="https://usethis.r-lib.org/reference/use_lifecycle.html">usethis::use_lifecycle()</a></code> to do some one-time setup:</p>
<div class="cell">
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">usethis</span><span class="fu">::</span><span class="fu"><a href="https://usethis.r-lib.org/reference/use_lifecycle.html">use_lifecycle</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; ✔ Adding 'lifecycle' to Imports field in DESCRIPTION</span></span>
<span><span class="co">#&gt; • Refer to functions with `lifecycle::fun()`</span></span>
<span><span class="co">#&gt; ✔ Adding '@importFrom lifecycle deprecated' to 'R/somepackage-package.R'</span></span>
<span><span class="co">#&gt; ✔ Writing 'NAMESPACE'</span></span>
<span><span class="co">#&gt; ✔ Creating 'man/figures/'</span></span>
<span><span class="co">#&gt; ✔ Copied SVG badges to 'man/figures/'</span></span>
<span><span class="co">#&gt; • Add badges in documentation topics by inserting one of:</span></span>
<span><span class="co">#&gt;   #' `r lifecycle::badge('experimental')`</span></span>
<span><span class="co">#&gt;   #' `r lifecycle::badge('superseded')`</span></span>
<span><span class="co">#&gt;   #' `r lifecycle::badge('deprecated')`</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This leaves you in a position to use lifecycle badges in help topics (and to use lifecycle functions, which we discuss in ??). For a function, include the badge in its <code>@description</code> block. Here’s how we indicate that <code><a href="https://dplyr.tidyverse.org/reference/top_n.html">dplyr::top_n()</a></code> is “superseded”:</p>
<div class="cell">
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#' Select top (or bottom) n rows (by value)</span></span>
<span><span class="co">#'</span></span>
<span><span class="co">#' @description</span></span>
<span><span class="co">#' `r lifecycle::badge("superseded")`</span></span>
<span><span class="co">#' `top_n()` has been superseded in favour of [slice_min()]/[slice_max()]....</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>For a function argument, include the badge in the <code>@param</code> tag. Here’s how the deprecation of <code>readr::write_file(path =)</code> is indicated:</p>
<div class="cell">
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#' @param path `r lifecycle::badge("deprecated")` Use the `file` argument</span></span>
<span><span class="co">#'   instead.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Call <code><a href="https://usethis.r-lib.org/reference/badges.html">usethis::use_lifecycle_badge()</a></code> if you want to use a badge in README to indicate the lifecycle of an entire package.</p>
<p>If the lifecycle of a package is “stable”, we might not bother with a badge, as “stable” is the assumed default. Similarly, we typically only use a badge for a function or argument if its stage differs from the overall stage of the package.</p>
</section><section id="deprecating-a-function-or-argument" class="level3" data-number="22.7.2"><h3 data-number="22.7.2" class="anchored" data-anchor-id="deprecating-a-function-or-argument">
<span class="header-section-number">22.7.2</span> Deprecating a function or argument</h3>
<p>If you’re going to remove a function or argument, it’s usually best to do so in phases. Deprecation is a general term for the situation where something is explicitly discouraged, but it has not yet been removed.</p>
<p>The <code><a href="https://lifecycle.r-lib.org/reference/deprecate_soft.html">lifecycle::deprecate_warn()</a></code> function can be used inside a function to inform your user that they’re using a deprecated feature and, ideally, to let them know about the preferred alternative.</p>
<div class="cell" data-r.options="{&quot;lifecycle:::calling_package&quot;:&quot;somepackage&quot;,&quot;lifecycle_verbosity&quot;:&quot;warning&quot;}">
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># new function</span></span>
<span><span class="va">add3</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, <span class="va">z</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">x</span> <span class="op">+</span> <span class="va">y</span> <span class="op">+</span> <span class="va">z</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># old function</span></span>
<span><span class="va">plus3</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, <span class="va">z</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu">lifecycle</span><span class="fu">::</span><span class="fu"><a href="https://lifecycle.r-lib.org/reference/deprecate_soft.html">deprecate_warn</a></span><span class="op">(</span><span class="st">"1.0.0"</span>, <span class="st">"plus3()"</span>, <span class="st">"add3()"</span><span class="op">)</span></span>
<span>  <span class="fu">add3</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, <span class="va">z</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu">plus3</span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: `plus3()` was deprecated in somepackage 1.0.0.</span></span>
<span><span class="co">#&gt; ℹ Please use `add3()` instead.</span></span>
<span><span class="co">#&gt; [1] 6</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>At this point, a user who calls <code>plus3()</code> sees a warning explaining that the function has a new name, but we go ahead and call <code>add3()</code> with their inputs. Pre-existing code still “works”. In some future major release, <code>plus3()</code> could be removed entirely.</p>
<p>When you’re deprecating an argument, you can also use <code>lifecycle::deprecate()</code> as its default value. Here we continue an example from above, i.e.&nbsp;the switch from <code>path</code> to <code>file</code> in <code><a href="https://readr.tidyverse.org/reference/read_file.html">readr::write_file()</a></code>:</p>
<div class="cell">
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">write_file</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>,</span>
<span>                       <span class="va">file</span>,</span>
<span>                       <span class="va">append</span> <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                       <span class="va">path</span> <span class="op">=</span> <span class="fu">deprecated</span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu">is_present</span><span class="op">(</span><span class="va">path</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu">deprecate_warn</span><span class="op">(</span><span class="st">"1.4.0"</span>, <span class="st">"write_file(path = )"</span>, <span class="st">"write_file(file = )"</span><span class="op">)</span></span>
<span>    <span class="va">file</span> <span class="op">&lt;-</span> <span class="va">path</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="va">...</span></span>
<span><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>TODO: Say more about <code>deprecated()</code>. What’s the point? Visual signal to the user + works with <code><a href="https://lifecycle.r-lib.org/reference/deprecated.html">lifecycle::is_present()</a></code>. Why we think it’s OK to call it as <code>deprecated()</code> and not <code><a href="https://lifecycle.r-lib.org/reference/deprecated.html">lifecycle::deprecated()</a></code>.</p>
<p>Here’s a hypothetical blueprint for removing a function <code>fun()</code>:</p>
<ul>
<li><p>Package version <code>0.5.0</code>: <code>fun()</code> exists. The lifecycle stage of the package is “experimental”, as indicated by the pre-<code>1.0.0</code> version number and, perhaps, a package-level badge. The lifecycle stage of <code>fun()</code> is also “experimental”, by extension.</p></li>
<li><p>Package version <code>0.6.0</code>: The deprecation process of <code>fun()</code> begins. We insert in its <code>@description</code> to place a badge in its help topic. In the body of <code>fun()</code>, we add a call to <code><a href="https://lifecycle.r-lib.org/reference/deprecate_soft.html">lifecycle::deprecate_warn()</a></code> to inform users about the situation.</p></li>
<li><p>Package version <code>0.7.0</code> or <code>1.0.0</code>: <code>fun()</code> is removed. Whether this happens in a minor or major release will depend on the context, i.e.&nbsp;how widely used this package and function are.</p></li>
</ul>
<p>TODO: mention <code><a href="https://rdrr.io/r/base/Deprecated.html">.Deprecated()</a></code> as the base way. Also maybe mention <code>!missing(x)</code> as a base alternative to <code>deprecated()</code> + <code>is_present()</code>.</p>
<p>TODO: update everything after this point.</p>
<ul>
<li>
<p>If you’re deprecating a lot of code, it can be useful to add a helper function. For example, ggplot2 has <code>gg_dep</code> which automatically displays a message, warning or error, depending on how much the version number has changed.</p>
<div class="cell">
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">gg_dep</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">version</span>, <span class="va">msg</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">v</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric_version.html">as.package_version</a></span><span class="op">(</span><span class="va">version</span><span class="op">)</span></span>
<span>  <span class="va">cv</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/packageDescription.html">packageVersion</a></span><span class="op">(</span><span class="st">"ggplot2"</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># If current major number is greater than last-good major number, or if</span></span>
<span>  <span class="co"># current minor number is more than 1 greater than last-good minor number,</span></span>
<span>  <span class="co"># return an error.</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">cv</span><span class="op">[[</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="op">&gt;</span> <span class="va">v</span><span class="op">[[</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">]</span><span class="op">]</span>  <span class="op">||</span>  <span class="va">cv</span><span class="op">[[</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">]</span><span class="op">]</span> <span class="op">&gt;</span> <span class="va">v</span><span class="op">[[</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">]</span><span class="op">]</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/stop.html">stop</a></span><span class="op">(</span><span class="va">msg</span>, <span class="st">" (Defunct; last used in version "</span>, <span class="va">version</span>, <span class="st">")"</span>,</span>
<span>      call. <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># If minor number differs by one, give a warning</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span> <span class="op">(</span><span class="va">cv</span><span class="op">[[</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">]</span><span class="op">]</span> <span class="op">&gt;</span> <span class="va">v</span><span class="op">[[</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/warning.html">warning</a></span><span class="op">(</span><span class="va">msg</span>, <span class="st">" (Deprecated; last used in version "</span>, <span class="va">version</span>, <span class="st">")"</span>,</span>
<span>      call. <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># If only subminor number is greater, provide a message</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span> <span class="op">(</span><span class="va">cv</span><span class="op">[[</span><span class="fl">1</span>,<span class="fl">3</span><span class="op">]</span><span class="op">]</span> <span class="op">&gt;</span> <span class="va">v</span><span class="op">[[</span><span class="fl">1</span>,<span class="fl">3</span><span class="op">]</span><span class="op">]</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/message.html">message</a></span><span class="op">(</span><span class="va">msg</span>, <span class="st">" (Deprecated; last used in version "</span>, <span class="va">version</span>, <span class="st">")"</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/invisible.html">invisible</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</li>
<li><p>Significant changes to an existing function requires planning, including making gradual changes over multiple versions. Try and develop a sequence of transformations where each change can be accompanied by an informative error message.</p></li>
<li>
<p>If you want to use functionality in a new version of another package, don’t make it a hard install-time dependency in the <code>DESCRIPTION</code> (forcing your users to upgrade that package might break other code). Instead check for the version at run-time:</p>
<div class="cell">
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/packageDescription.html">packageVersion</a></span><span class="op">(</span><span class="st">"ggplot2"</span><span class="op">)</span> <span class="op">&lt;</span> <span class="st">"1.0.0"</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/stop.html">stop</a></span><span class="op">(</span><span class="st">"ggplot2 &gt;= 1.0.0 needed for this function."</span>, call. <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This is also useful if you’re responding to changes in one of your dependencies - you’ll want to have a version that will work both before and after the change. This will allow you to submit it to CRAN at any time, even before the other package. Doing this may generate some <code>R CMD check</code> notes. For example:</p>
<div class="cell">
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/packageDescription.html">packageVersion</a></span><span class="op">(</span><span class="st">"foo"</span><span class="op">)</span> <span class="op">&gt;</span> <span class="st">"1.0.0"</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu">foo</span><span class="fu">::</span><span class="fu">baz</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>  <span class="fu">foo</span><span class="fu">::</span><span class="fu">bar</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>If <code>baz</code> doesn’t exist in foo version 1.0.0, you’ll get a note that it doesn’t exist in foo’s namespace. Just explain that you’re working around a difference between versions in your submission to CRAN.</p>
</li>
</ul></section></section><section id="sec-release" class="level2" data-number="22.8"><h2 data-number="22.8" class="anchored" data-anchor-id="sec-release">
<span class="header-section-number">22.8</span> Releasing to CRAN</h2>
<p>If you want your package to have significant traction in the R community, you need to submit it to CRAN. Submitting to CRAN is a lot more work than just providing a version on github, but the vast majority of R users do not install packages from github, because CRAN provides discoverability, ease of installation and a stamp of authenticity. The CRAN submission process can be frustrating, but it’s worthwhile, and this chapter will make it as painless as possible.</p>
<p>To get your package ready to release, follow these steps:</p>
<ol type="1">
<li>Pick a version number.</li>
<li>Run and document <code>R CMD check</code>.</li>
<li>Check that you’re aligned with CRAN policies.</li>
<li>Update <code>README.md</code> and <code>NEWS.md</code>.</li>
<li>Submit the package to CRAN.</li>
<li>Prepare for the next version by updating version numbers.</li>
<li>Publicise the new version.</li>
</ol>
<section id="sec-release-process" class="level3" data-number="22.8.1"><h3 data-number="22.8.1" class="anchored" data-anchor-id="sec-release-process">
<span class="header-section-number">22.8.1</span> The submission process</h3>
<p>To manually submit your package to CRAN, you create a package bundle (with <code><a href="https://devtools.r-lib.org/reference/build.html">devtools::build()</a></code>) then upload it to <a href="https://cran.r-project.org/submit.html" class="uri">https://cran.r-project.org/submit.html</a>, along with some comments which describe the process you followed. This section shows you how to make submission as easy as possible by providing a standard structure for those comments. Later, in <a href="#sec-release-submission"><span>Section&nbsp;22.8.7</span></a>, you’ll see how to actually submit the package with <code><a href="https://devtools.r-lib.org/reference/release.html">devtools::release()</a></code>.</p>
<p>When submitting to CRAN, remember that CRAN is staffed by volunteers, all of whom have other full-time jobs. A typical week has over 100 submissions and only three volunteers to process them all. The less work you make for them the more likely you are to have a pleasant submission experience.</p>
<p>I recommend that you store your submission comments in a file called <code>cran-comments.md</code>. <code>cran-comments.md</code> should be checked into git (so you can track it over time), and listed in <code>.Rbuildignore</code> (so it’s not included in the package). As the extension suggests, I recommend using Markdown because it gives a standard way of laying out plain text. However, because the contents will never be rendered to another format, you don’t need to worry about sticking to it too closely. Here are the <code>cran-comments.md</code> from a recent version of httr:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode md code-with-copy"><code class="sourceCode markdown"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">## R CMD check results</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>There were no ERRORs or WARNINGs. </span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>There was 1 NOTE:</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>checking dependencies in R code ... NOTE</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>  Namespace in Imports field not imported from: 'R6'</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>  R6 is a build-time dependency.</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a><span class="fu">## Downstream dependencies</span></span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>I have also run R CMD check on downstream dependencies of httr </span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>(https://github.com/wch/checkresults/blob/master/httr/r-release). </span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>All packages that I could install passed except:</span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Ecoengine: this appears to be a failure related to config on </span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a>  that machine. I couldn't reproduce it locally, and it doesn't </span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a>  seem to be related to changes in httr (the same problem exists </span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a>  with httr 0.4).</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>This layout is designed to be easy to skim, and easy to match up to the <code>R CMD check</code> results seen by CRAN maintainers. It includes two sections:</p>
<ol type="1">
<li><p>Check results: I always state that there were no errors or warnings. Any <code>NOTE</code>s go in a bulleted list. For each <code>NOTE</code>, I include the message from <code>R CMD check</code> and a brief description of why I think it’s OK. If there were no <code>NOTE</code>s, I’d say “There were no ERRORs, WARNINGs or NOTEs”</p></li>
<li><p>Downstream dependencies: If there are downstream dependencies, I run <code>R CMD check</code> on each package and summarise the results. If there are no downstream dependencies, keep this section, but say: “There are currently no downstream dependencies for this package”.</p></li>
</ol>
<p>These are described in more detail below.</p>
</section><section id="release-test-env" class="level3" data-number="22.8.2"><h3 data-number="22.8.2" class="anchored" data-anchor-id="release-test-env">
<span class="header-section-number">22.8.2</span> Test environments</h3>
<p>When checking your package you need to make sure that it passed with the current development version of R and it works on at least two platforms. <code>R CMD check</code> is continuously evolving, so it’s a good idea to check your package with the latest development version, <strong>R-devel</strong>. You can install R-devel on your own machine:</p>
<ul>
<li><p>Mac: install from <a href="https://mac.r-project.org/" class="uri">https://mac.r-project.org/</a>.</p></li>
<li><p>Windows: install from <a href="https://cran.r-project.org/bin/windows/base/rdevel.html" class="uri">https://cran.r-project.org/bin/windows/base/rdevel.html</a></p></li>
<li><p>Linux: either build it from source, or better, learn about Docker containers and run the R-devel container from <a href="https://github.com/rocker-org/rocker" class="uri">https://github.com/rocker-org/rocker</a>.</p></li>
</ul>
<p>It’s painful to manage multiple R versions, especially since you’ll need to reinstall all your packages. Instead, you can run <code>R CMD check</code> on CRAN’s servers with the <code>devtools::check_win_*()</code> family of functions. They build your package and submit it to the CRAN win-builder. 10-20 minutes after submission, you’ll receive an e-mail telling you the check results.</p>
<p>CRAN runs on multiple platforms: Windows, Mac OS X, Linux, and Solaris. You don’t need to run <code>R CMD check</code> on every one of these platforms, but it’s a really good idea to do it on at least two. This increases your chances of spotting code that relies on the idiosyncrasies of specific platform. There are two easy ways to check on different platforms:</p>
<ul>
<li><p><code>rhub::check()</code> which lets you manually run <code>R CMD check</code> on the platform of your choosing.</p></li>
<li><p><code><a href="https://usethis.r-lib.org/reference/github_actions.html">usethis::use_github_action_check_standard()</a></code> which helps you set up GitHub actions to automatically run <code>R CMD check</code> every time you push to GitHub.</p></li>
</ul>
<p>Debugging code that works on your computer but fails elsewhere is painful. If that happens to you, either install a virtualisation tool so that you can run another operating system locally, or find a friend to help you figure out the problem. Don’t submit the package and hope CRAN will help you figure out the problem.</p>
</section><section id="sec-cran-flavors-services" class="level3" data-number="22.8.3"><h3 data-number="22.8.3" class="anchored" data-anchor-id="sec-cran-flavors-services">
<span class="header-section-number">22.8.3</span> CRAN check flavors and related services</h3>
<p><em>This section just got transplanted from elsewhere. Still needs integrating into its new home.</em></p>
<p>CRAN runs <code>R CMD check</code> on all contributed packages on a regular basis, on multiple platforms or what they call “flavors”. This check includes, but is not limited to, your testthat tests. CRAN’s check flavors almost certainly include platforms other than your preferred development environment(s), so you must proactively plan ahead if you want your tests to pass there.</p>
<p>You can see CRAN’s current check flavors here: <a href="https://cran.r-project.org/web/checks/check_flavors.html" class="uri">https://cran.r-project.org/web/checks/check_flavors.html</a>. There are various combinations of:</p>
<ul>
<li>Operating system and CPU: Windows, macOS (x86_64, arm64), Linux (various distributions)</li>
<li>R version: r-devel, r-release, r-oldrel</li>
<li>C, C++, FORTRAN compilers</li>
<li>Locale, in the sense of the <code>LC_CTYPE</code> environment variable (this is about which human language is in use and character encoding)</li>
</ul>
<p>It would be impractical for individual package developers to personally maintain all of these testing platforms. Instead, we turn to various community- and CRAN-maintained resources to test our packages. In order of how often we use them:</p>
<ul>
<li>
<p>GitHub Actions (GHA). Many R package developers host their source code on GitHub and use GHA to check their package, e.g., every time they push.</p>
<p>The usethis package offers several functions to help you configure GHA workflows for checking your package. The most appropriate level of checking depends on the nature of your user base and how likely it is that your package could behave differently across the flavors (e.g.&nbsp;does it contain compiled code?)</p>
<ul>
<li>
<code><a href="https://usethis.r-lib.org/reference/github_actions.html">usethis::use_github_action_check_release()</a></code>: an entry-level, bare-minimum workflow that checks with the latest release of R on Linux.</li>
<li>
<code><a href="https://usethis.r-lib.org/reference/github_actions.html">usethis::use_github_action_check_standard()</a></code>: Covers the three major operating systems and both the released and development versions of R. This is a good choice for a package that is (or aspires to be) on CRAN or Bioconductor.</li>
<li>The tidyverse/r-lib team uses an even more extensive check matrix, which would be overkill for most other packages. It’s necessary in this case in order to meet our commitment to support the current version, the development version, and four previous versions of R.</li>
</ul>
</li>
<li>
<p>R-hub builder (R-hub). This is a service supported by the R Consortium where package developers can submit their package for checks that replicate various CRAN check flavors. This is useful when you’re doing the due diligence leading up to a CRAN submission.</p>
<p>You can use R-hub via a web interface (<a href="https://builder.r-hub.io" class="uri">https://builder.r-hub.io</a>) or, as we recommend, through the <a href="https://r-hub.github.io/rhub/">rhub R package</a>.</p>
<p>The <code>rhub::check_for_cran()</code> function is morally similar to the GHA workflow configured by <code><a href="https://usethis.r-lib.org/reference/github_actions.html">usethis::use_github_action_check_standard()</a></code>, i.e.&nbsp;it’s a good solution for a typical package heading to CRAN. rhub has many other functions for accessing individual check flavors.</p>
</li>
<li>
<p>Win-Builder is a service maintained by the CRAN personnel who build the Windows binaries for CRAN packages. You use it in a similar way as R-hub, i.e.&nbsp;it’s a good check to run when preparing a CRAN submission. (Win-Builder is basically the inspiration for R-hub, i.e.&nbsp;Win-builder is such a convenient service that it makes sense to extend it for more flavors.)</p>
<p>The Win-Builder homepage (<a href="https://win-builder.r-project.org" class="uri">https://win-builder.r-project.org</a>) explains how to upload a package via ftp, but we recommend using the convenience functions <code><a href="https://devtools.r-lib.org/reference/check_win.html">devtools::check_win_devel()</a></code> and friends.</p>
</li>
<li>
<p>macOS builder is a service maintained by the CRAN personnel who build the macOS binaries for CRAN packages. This is a relatively new addition to the list and checks packages with “the same setup and available packages as the CRAN M1 build machine”.</p>
<p>You can submit your package using the web interface (<a href="https://mac.r-project.org/macbuilder/submit.html" class="uri">https://mac.r-project.org/macbuilder/submit.html</a>) or with <code><a href="https://devtools.r-lib.org/reference/check_mac_release.html">devtools::check_mac_release()</a></code>.</p>
</li>
</ul></section><section id="release-check" class="level3" data-number="22.8.4"><h3 data-number="22.8.4" class="anchored" data-anchor-id="release-check">
<span class="header-section-number">22.8.4</span> Check results</h3>
<p>You’ve already learned how to use <code>R CMD check</code> and why it’s important in <a href="workflow101.html#sec-workflow101-r-cmd-check"><span>Section&nbsp;5.6</span></a>. Compared to running <code>R CMD check</code> locally, there are a few important differences when running it for a CRAN submission:</p>
<ul>
<li><p>You must fix all <code>ERROR</code>s and <code>WARNING</code>s. A package that contains any errors or warnings will not be accepted by CRAN.</p></li>
<li>
<p>Eliminate as many <code>NOTE</code>s as possible. Each <code>NOTE</code> requires human oversight, which is a precious commodity. If there are notes that you do not believe are important, it is almost always easier to fix them (even if the fix is a bit of a hack) than to persuade CRAN that they’re OK. See <a href="R-CMD-check.html"><span>Appendix&nbsp;A</span></a> for details on how to fix individual problems.</p>
<p>If you have no <code>NOTE</code>s it is less likely that your package will be flagged for additional human checks. These are time consuming for both you and CRAN, so are best avoided if possible.</p>
</li>
<li>
<p>If you can’t eliminate a <code>NOTE</code>, document it in <code>cran-comments.md</code>, describing why you think it is spurious. Your comments should be easy to scan, and easy to match up with <code>R CMD check</code>. Provide the CRAN maintainers with everything they need in one place, even if it means repeating yourself.</p>
<p>NB: There will always be one <code>NOTE</code> when you first submit your package. This reminds CRAN that this is a new submission and that they’ll need to do some extra checks. You can’t eliminate this, so just mention in <code>cran-comments.md</code> that this is your first submission.</p>
</li>
</ul></section><section id="release-deps" class="level3" data-number="22.8.5"><h3 data-number="22.8.5" class="anchored" data-anchor-id="release-deps">
<span class="header-section-number">22.8.5</span> Reverse dependencies</h3>
<p>Finally, if you’re releasing a new version of an existing package, it’s your responsibility to check that downstream dependencies (i.e.&nbsp;all packages that list your package in the <code>Depends</code>, <code>Imports</code>, <code>Suggests</code> or <code>LinkingTo</code> fields) continue to work. To help you do this, <del>devtools provides <code>devtools::revdep_check()</code></del>. <em>This section is slated for revision for the 2nd edition. In the meantime, know that this functionality is now provided by the <a href="https://r-lib.github.io/revdepcheck/">revdepcheck</a> package.</em> This:</p>
<ol type="1">
<li><p>Sets up a temporary library so it doesn’t clobber any existing packages you have installed.</p></li>
<li><p>Installs all of the dependencies of the downstream dependencies.</p></li>
<li><p>Runs <code>R CMD check</code> on each package.</p></li>
<li><p>Summarises the results in a single file.</p></li>
</ol>
<p>Run <code><a href="https://usethis.r-lib.org/reference/use_revdep.html">usethis::use_revdep()</a></code> to set up your package with a useful template.</p>
<p>If any packages fail <code>R CMD check</code>, you should give package authors at least two weeks to fix the problem before you submit your package to CRAN (you can easily get all maintainer e-mail addresses with <code>revdep_maintainers()</code>). After the two weeks is up, re-run the checks, and list any remaining failures in <code>cran-comments.md</code>. Each package should be accompanied by a brief explanation that either tells CRAN that it’s a false positive in <code>R CMD check</code> (e.g.&nbsp;you couldn’t install a dependency locally) or that it’s a legitimate change in the API (which the maintainer hasn’t fixed yet).</p>
<p>Inform CRAN of your release process: “I advised all downstream package maintainers of these problems two weeks ago”. Here’s an example from a recent release of dplyr:</p>
<pre><code>Important reverse dependency check notes (full details at 
https://github.com/wch/checkresults/tree/master/dplyr/r-release);

* COPASutils, freqweights, qdap, simPH: fail for various reasons. All package 
  authors were informed of the upcoming release and shown R CMD check issues 
  over two weeks ago.

* ggvis: You'll be receiving a submission that fixes these issues very shortly
  from Winston.

* repra, rPref: uses a deprecated function.</code></pre>
</section><section id="cran-policies" class="level3" data-number="22.8.6"><h3 data-number="22.8.6" class="anchored" data-anchor-id="cran-policies">
<span class="header-section-number">22.8.6</span> CRAN policies</h3>
<p>As well as the automated checks provided by <code>R CMD check</code>, there are a number of <a href="https://cran.r-project.org/web/packages/policies.html">CRAN policies</a> that must be checked manually. The CRAN maintainers will typically look at this very closely on a package’s first submission.</p>
<p>I’ve summarised the most common problems below:</p>
<ul>
<li><p>It’s vital that the maintainer’s e-mail address is stable because this is the only way that CRAN has to contact you, and if there are problems and they can’t get in touch with you they will remove your package from CRAN. So make sure it’s something that’s likely to be around for a while, and that it’s not heavily filtered.</p></li>
<li><p>You must have clearly identified the copyright holders in <code>DESCRIPTION</code>: if you have included external source code, you must ensure that the license is compatible. See <a href="license.html"><span>Chapter&nbsp;13</span></a> for more details.</p></li>
<li><p>You must “make all reasonable efforts” to get your package working across multiple platforms. Packages that don’t work on at least two will not normally be considered.</p></li>
<li><p>Do not make external changes without explicit user permission. Don’t write to the file system, change options, install packages, quit R, send information over the internet, open external software, etc.</p></li>
<li><p>Do not submit updates too frequently. The policy suggests a new version once every 1-2 months at most.</p></li>
</ul>
<p>I recommend following the <a href="https://twitter.com/CRANPolicyWatch">CRAN Policy Watch</a> Twitter account which tweets whenever there’s a policy change. You can also look at the GitHub repository that powers it: <a href="https://github.com/eddelbuettel/crp/commits/master/texi" class="uri">https://github.com/eddelbuettel/crp/commits/master/texi</a>.</p>
</section><section id="sec-release-submission" class="level3" data-number="22.8.7"><h3 data-number="22.8.7" class="anchored" data-anchor-id="sec-release-submission">
<span class="header-section-number">22.8.7</span> Release</h3>
<p>You’re now ready to submit your package to CRAN. The easiest way to do this is to run <code><a href="https://devtools.r-lib.org/reference/release.html">devtools::release()</a></code>. This:</p>
<ul>
<li><p>Builds the package and runs <code>R CMD check</code> one last time.</p></li>
<li><p>Asks you a number of yes/no questions to verify that you followed the most common best practices.</p></li>
<li>
<p>Allows you to add your own questions to the check process by including an unexported <code>release_questions()</code> function in your package. This should return a character vector of questions to ask. For example, httr has:</p>
<div class="cell">
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">release_questions</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>    <span class="st">"Have you run all the OAuth demos?"</span>,</span>
<span>    <span class="st">"Is inst/cacert.pem up to date?"</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This is useful for reminding you to do any manual tasks that can’t otherwise be automated.</p>
</li>
<li><p>Uploads the package bundle to the <a href="https://cran.r-project.org/submit.html">CRAN submission form</a> including the comments in <code>cran-comments.md</code>.</p></li>
</ul>
<p>Within the next few minutes, you’ll receive an email notifying you of the submission and asking you to approve it (this confirms that the maintainer address is correct). Next the CRAN maintainers will run their checks and get back to you with the results. This normally takes around 24 hours, but occasionally can take up to 5 days.</p>
</section><section id="on-failure" class="level3" data-number="22.8.8"><h3 data-number="22.8.8" class="anchored" data-anchor-id="on-failure">
<span class="header-section-number">22.8.8</span> On failure</h3>
<p>If your package does not pass <code>R CMD check</code> or is in violation of CRAN policies, a CRAN maintainer will e-mail you and describe the problem(s). Failures are frustrating, and the feedback may be curt and may feel downright insulting. Arguing with CRAN maintainers will likely waste both your time and theirs. Instead:</p>
<ul>
<li><p>Breathe. A rejected CRAN package is not the end of the world. It happens to everyone. Even members of R-core have to go through the same process and CRAN is no friendlier to them. I have had numerous packages rejected by CRAN. I was banned from submitting to CRAN for two weeks because too many of my existing packages had minor problems.</p></li>
<li><p>If the response gets you really riled up, take a couple of days to cool down before responding. Ignore any ad hominem attacks, and strive to respond only to technical issues.</p></li>
<li><p>If a devtools problem causes a CRAN maintainer to be annoyed with you, I am deeply sorry. If you forward me the message along with your address, I’ll send you a hand-written apology card.</p></li>
</ul>
<p>Unless you feel extremely strongly that discussion is merited, don’t respond to the e-mail. Instead:</p>
<ul>
<li><p>Fix the identified problems and make recommended changes. Re-run <code><a href="https://devtools.r-lib.org/reference/check.html">devtools::check()</a></code> to make sure you didn’t accidentally introduce any new problems.</p></li>
<li>
<p>Add a “Resubmission” section at the top of <code>cran-comments.md</code>. This should clearly identify that the package is a resubmission, and list the changes that you made.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode md code-with-copy"><code class="sourceCode markdown"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">## Resubmission</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>This is a resubmission. In this version I have:</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Converted the DESCRIPTION title to title case.</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>More clearly identified the copyright holders in the DESCRIPTION</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>  and LICENSE files.</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</li>
<li><p>If necessary, update the check results and downstream dependencies sections.</p></li>
<li><p>Run <code><a href="https://devtools.r-lib.org/reference/submit_cran.html">devtools::submit_cran()</a></code> to re-submit the package without working through all the <code>release()</code> questions a second time.</p></li>
</ul></section><section id="binary-builds" class="level3" data-number="22.8.9"><h3 data-number="22.8.9" class="anchored" data-anchor-id="binary-builds">
<span class="header-section-number">22.8.9</span> Binary builds</h3>
<p>After the package has been accepted by CRAN it will be built for each platform. It’s possible this may uncover further errors. Wait 48 hours until all the checks for all packages have been run, then go to the check results page for your package:</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="images/cran-checks.png" class="img-fluid"></p>
</div>
</div>
<p>Prepare a patch release that fixes the problems and submit using the same process as above.</p>
</section><section id="post-release" class="level3" data-number="22.8.10"><h3 data-number="22.8.10" class="anchored" data-anchor-id="post-release">
<span class="header-section-number">22.8.10</span> Prepare for next version</h3>
<p>Once your package has been accepted by CRAN, you have a couple of technical tasks to do:</p>
<ul>
<li><p>If you use GitHub, go to the repository release page. Create a new release with tag version <code>v1.2.3</code> (i.e.&nbsp;“v” followed by the version of your package). Copy and paste the contents of the relevant <code>NEWS.md</code> section into the release notes.</p></li>
<li><p>If you use git, but not GitHub, tag the release with <code>git tag -a v1.2.3</code>.</p></li>
<li><p>Add the <code>.9000</code> suffix to the <code>Version</code> field in the DESCRIPTION to indicate that this is a development version. Create a new heading in <code>NEWS.md</code> and commit the changes.</p></li>
</ul></section><section id="promotion" class="level3" data-number="22.8.11"><h3 data-number="22.8.11" class="anchored" data-anchor-id="promotion">
<span class="header-section-number">22.8.11</span> Publicising your package</h3>
<p>Now you’re ready for the fun part: publicising your package. This is really important. No one will use your helpful new package if they don’t know that it exists.</p>
<p>Start by writing a release announcement. This should be an R Markdown document that briefly describes what the package does (so people who haven’t used it before can understand why they should care), and what’s new in this version. Start with the contents of <code>NEWS.md</code>, but you’ll need to modify it. The goal of <code>NEWS.md</code> is to be comprehensive; the goal of the release announcement is to highlight the most important changes. Include a link at the end of the announcement to the full release notes so people can see all the changes. Where possible, I recommend showing examples of new features: it’s much easier to understand the benefit of a new feature if you can see it in action.</p>
<p>There are a number of places you can include the announcement:</p>
<ul>
<li><p>If you have a blog, publish it there. I now publish all package release announcements on the <a href="https://blog.rstudio.org/author/hadleywickham/">RStudio blog</a>.</p></li>
<li><p>If you use Twitter, tweet about it with the #rstats hashtag.</p></li>
<li><p>Send it to the <a href="https://stat.ethz.ch/mailman/listinfo/r-packages">r-packages mailing list</a>. Messages sent to this list are automatically forwarded to the R-help mailing list.</p></li>
</ul></section><section id="congratulations" class="level3" data-number="22.8.12"><h3 data-number="22.8.12" class="anchored" data-anchor-id="congratulations">
<span class="header-section-number">22.8.12</span> Congratulations!</h3>
<p>You have released your first package to CRAN and made it to the end of the book!</p>


</section></section><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><hr>
<ol>
<li id="fn1"><p>It’s unusual for an initial release to be version 1.0.0, but remember that usethis was basically carved out of a very mature package (devtools).<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>We can call <code><a href="https://rdrr.io/r/base/numeric_version.html">package_version()</a></code> directly here, but in package code, you should use the <code>utils::package_version()</code> form and list the utils package in <code>Imports</code>.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p>As with <code><a href="https://rdrr.io/r/base/numeric_version.html">package_version()</a></code>, in package code, you should use the <code><a href="https://rdrr.io/r/utils/packageDescription.html">utils::packageVersion()</a></code> form and list the utils package in <code>Imports</code>.<a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn4"><p>For some suitably pragmatic definition of “backward compatible”.<a href="#fnref4" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol></section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./software-development-practices.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Software development practices</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./references.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">References</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>